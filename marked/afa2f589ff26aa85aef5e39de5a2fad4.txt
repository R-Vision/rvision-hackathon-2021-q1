<ORG>Trend Micro</ORG>
Research Paper
2012
<THREAT_ACTOR>LUCKYCAT</THREAT_ACTOR> REDUX
Inside an APT
Campaign with
Multiple Targets in
India and Japan
By: Forward-Looking Threat Research Team

CONTENTS
Introduction..................................................................................... 1 Attribution.......................................................................................11
Diversity of Targets................................................................. 1 Campaign Connections................................................................12
Diversity of Malware.............................................................. 2 <MALWARE>Shadow</MALWARE>Net..............................................................................12
Diversity of Infrastructure.................................................... 2 <MALWARE>Duo</MALWARE>jeen....................................................................................13
Operations............................................................................... 2 Sparksrv..................................................................................15
Attribution............................................................................... 2 Comfoo.....................................................................................16
<THREAT_ACTOR>Luckycat</THREAT_ACTOR>........................................................................................... 3 Conclusion......................................................................................19
Examples of <THREAT_ACTOR>Luckycat</THREAT_ACTOR> Attacks.............................................4 Defending Against <THREAT_ACTOR>APT</THREAT_ACTOR>s..............................................................19
Example 1: Japan.............................................................4 Local and External Threat Intelligence ...........................19
Example 2: India..............................................................4 Mitigation and Cleanup Strategy......................................20
Example 3: Tibet.............................................................. 5 Educating Employees Against Social Engineering.......20
Vulnerabilities and Malware Samples....................................... 5 Data-Centric Protection Strategy.....................................20
Campaign Codes............................................................................ 7 <ORG>Trend Micro</ORG> Threat Protection Against Luckycat
Command and Control..................................................................8 Campaign Components...............................................................21
Operations....................................................................................... 9

INTRODUCTION
The number of targeted attacks has dramatically Cyber-espionage campaigns often focus on specific
increased. Unlike largely indiscriminate attacks that focus industries or communities of interest in addition to a
on stealing credit card and banking information associated geographic focus. Different positions of visibility often
with cybercrime, targeted attacks noticeably differ and yield additional sets of targets pursued by the same threat
are better characterized as “cyber espionage.” Highly actors. We have been tracking the campaign dubbed
targeted attacks are computer intrusions threat actors “<THREAT_ACTOR>Luckycat</THREAT_ACTOR>” and found that in addition to targeting Indian
stage in order to aggressively pursue and compromise military research institutions, as previously revealed by
specific targets, often leveraging social engineering, in <ORG>Symantec</ORG>, the same campaign targeted entities in Japan
order to maintain persistent presence within the victim’s as well as the Tibetan community.3
network so they can move laterally and extract sensitive
information.1 The <CAMPAIGN>Luckycat</CAMPAIGN> campaign targeted the following industries
and/or communities:
In a typical targeted attack, a target receives a
contextually relevant email that encourages a potential • <INDUSTRY>Aerospace</INDUSTRY> • <INDUSTRY>Shipping</INDUSTRY>
victim to click a link or open a file.2 The links and files
the attackers send contain malicious code that exploits • <INDUSTRY>Energy</INDUSTRY> • <INDUSTRY>Military research</INDUSTRY>
vulnerabilities in popular software. The exploits’ payload
is a malware that is silently executed on the target’s • <INDUSTRY>Engineering</INDUSTRY> • Tibetan activists
computer. This exploitation allows the attackers to
take control of and obtain data from the compromised The <CAMPAIGN>Luckycat</CAMPAIGN> campaign attacked a diverse set of targets
computer. In other cases, the attackers send disguised using a variety of malware, some of which have been
executable files, usually compressed in archives that, linked to other cyber-espionage campaigns. The attackers
if opened, also compromise the target’s computer. The behind this campaign maintain a diverse set of C&C
malware connects back to command-and-control (C&C) infrastructure and leverages anonymity tools to obfuscate
servers under the attackers’ control from which they their operations. We were able to track elements of this
can command the compromised computer to download campaign to hackers based in <GEO>China</GEO>.
additional malware and tools that allow them to move
laterally throughout the target’s network. These attacks
are, however, not isolated “smash-and-grab” incidents but
Diversity of Targets
are part of consistent campaigns that aim to establish
covert presence in a target’s network so that information The <CAMPAIGN>Luckycat</CAMPAIGN> campaign, which has been active since at
can be extracted as needed. least June 2011, has been linked to 90 attacks against
targets in Japan and India as well as Tibetan activists.
Targeted attacks are rarely isolated events. In fact, Each malware attack involves a unique campaign code that
they are constant. It is more useful to think of them as can be used to track which victims were compromised by
campaigns—a series of failed and successful attempts which malware attack. This illustrates that the attackers
to compromise a target’s network over a certain period are both very aggressive and continually target their
of time. The attackers, in fact, often keep track of the intended victims. These are not smash-and-grab attacks
different attacks within a campaign in order to determine but constitute a “campaign” comprising a series of
which individual attack compromised a specific victim’s ongoing attacks over time. In sum, the <CAMPAIGN>Luckycat</CAMPAIGN> campaign
network. As the attackers learn more about their targets managed to compromise 233 computers.4
from open source research—relying on publicly available
information, as well as previous attacks, the specificity of
the attacks may sharply increase.
1 http://www.trendmicro.com/cloud-content/us/pdfs/security- 3 http://www.symantec.com/content/en/us/enterprise/media/security_
intelligence/white-papers/wp_trends-in-targeted-attacks.pdf response/whitepapers/the_luckycat_hackers.pdf
2 Targeted attacks can sometimes be conducted through instant 4 This number represents the unique MAC addresses of the victims that
messages instead of emails. were stored by the attackers on their C&C infrastructure.
PAGE 1 | LUCKYCAT REDUX

Diversity of Malware Operations
We were able to identify five malware families either <MALWARE>TROJ_WIMMIE</MALWARE>, favored by the <THREAT_ACTOR>Luckycat</THREAT_ACTOR> attackers, bundles
utilized by or hosted on the same dedicated server the a significant amount of information on the victim and
<CAMPAIGN>Luckycat</CAMPAIGN> campaign uses. Some were used as second- uploads it to a C&C server. One such file recovered from
stage malware that the attackers pushed to victims whose a C&C server is actually the result of a test run by the
networks were compromised by first-stage malware. attackers. The information reveals that the attackers use
Second-stage malware typically provide additional proxy and anonymity tools to shield their identities as
functionality and are especially used if the first-stage well as a variety of mailing programs to instigate targeted
malware prove very simplistic. In addition, we found that attacks. In addition, the language settings of the attackers’
the attackers used multiple malware families that coincide computers indicate that they are Chinese speakers. This is
with malware that have been used in other campaigns. consistent with the information <ORG>Symantec</ORG> obtained, which
This indicates a level of collaboration across campaigns. shows that the attackers logged in to their C&C server
from IP addresses allocated to <GEO>China</GEO>.
Diversity of Infrastructure
Attribution
The <CAMPAIGN>Luckycat</CAMPAIGN> campaign use free web-hosting services
that provide a diversity of domain names as well as IP Using open source research, we were able to connect
addresses. This distributes the campaign, making it more the email address used to register one of the <MALWARE>Luckycat</MALWARE>
difficult to track. However, the attackers also made use C&C servers to a hacker in the Chinese underground
of Virtual Private Servers (VPSs) that not only housed community. He uses the nickname, “dang0102,” and has
their primary malware—<MALWARE>TROJ_WIMMIE</MALWARE>, but others as well.5 published posts in the famous hacker forum, XFocus,
These servers may also act as anchors, as servers on free as well as recruited others to join a research project on
hosting services are shut down for malicious activity. As a network attack and defense at the Information Security
result, the campaign stabilized its infrastructure over time, <ORG>Institute of the Sichuan University</ORG>. The hacker, also known
transferring victims, often through the use of second- as “scuhkr,” has authored articles related to backdoors and
stage malware, from free hosting servers to their stable shellcode in a hacking magazine.
core of VPSs.
5 VPSs are dedicated hosting services that can be purchased online.
PAGE 2 | <MALWARE>LUCKYCAT</MALWARE> REDUX

<MALWARE>LUCKYCAT</MALWARE>
The malware used in the <CAMPAIGN>Luckycat</CAMPAIGN> campaign, detected by The attacker then creates a file with a name that ends in
Trend Micro as <MALWARE>TROJ_WIMMIE6</MALWARE> or VBS_WIMMIE,7 connects @.c, which contains a command.
to a C&C server via HTTP over port 80. It is notable
because it uses Windows Management Instrumentation [HOSTNAME]_[MAC_ADDRESS]_[CAMPAIGN_
(WMI)8 to establish persistence.9 VBS_WIMMIE registers a CODE]@.c
script that works as a backdoor to the WMI event handler
and deletes files associated with it or TROJ_WIMMIE. As The compromised computer then downloads the file and
a result, the backdoor cannot be detected by antivirus executes the specified command, which may include any
software through simple file scanning. of the following:
• Get external IP address
The compromised computer posts data to a PHP script • Download file
that runs on the C&C server, usually count.php. • Execute shell command
• Upload file
POST/count/count.php?m=c&n=[HOSTNAME]_
[MAC_ADDRESS]_[CAMPAIGN_CODE]@HTTP/1.0 The compromised computer then sends the output to the
Accept: */* C&C server and deletes the command file:
UA-CPU: x86
User-Agent: Mozilla/4.0 (compatible; MSIE POST/count/count.php?m=w&n=[HOST_NAME]_
7.0; Windows NT 5.1; .NET CLR 2.0.50727; [MAC_ADDRESS]_[CAMPAIGN_CODE]@@.t HTTP/1.0
.NET CLR 3.0.4506.2152; .NET CLR POST/count/count.php?m=d&n=[HOST_NAME]_
3.5.30729) [MAC_ADDRESS]_[CAMPAIGN_CODE]@@.c HTTP/1.0
Host: [HOSTNAME]
Content-Length: 0 One of the common initial commands instructs the
Connection: Keep-Alive compromised computer to upload the results of
Pragma: no-cache
information-gathering commands. This command causes
the compromised computer to create a directory listing
The initial communication results in the creation of a
of the available drives, along with the output of the
file on the C&C server that contains information on the
commands, “ipconfig,” “tasklist,” and “systeminfo.” The
compromised computer. Although the file is empty, the
resulting files are compressed using the CAB compression
file name contains the hostname of the compromised
format and uploaded to the C&C server. This provides the
computer, followed by its MAC address, along with the
attackers a full set of information to evaluate the nature of
campaign code the attackers use to identify which
the compromised computer.
malware attack caused the compromise:
~[HOSTNAME]_[MAC_ADDRESS]_[CAMPAIGN_CODE]
6 http://about-threats.trendmicro.com/Malware.
aspx?language=us&name=TROJ_WIMMIE.C
7 http://about-threats.trendmicro.com/malware.
aspx?language=us&name=VBS_WIMMIE.C
8 The <MALWARE>Luckycat</MALWARE> malware may be notable but its technique is no longer
new, as the WMI malware featured in the paper cited below also
exhibited the same capability.
9 http://www.trendmicro.com/cloud-content/us/pdfs/security-
intelligence/white-papers/wp__understanding-wmi-malware.pdf
PAGE 3 | LUCKYCAT REDUX

Examples of <MALWARE>Luckycat</MALWARE> Attacks
Example 1: <GEO>Japan</GEO> Example 2: <GEO>India</GEO>
Figure 1: Decoy document opened after exploiting an Adobe
Reader vulnerability
A targeted email was sent to some organizations in <GEO>Japan</GEO>.
One of the attacks occurred during the confusion after Figure 2: Redacted decoy document opened after exploiting a
Microsoft Word vulnerability
the Great <GEO>East Japan</GEO> Earthquake and the <GEO>Fukushima</GEO>
Nuclear Power Plant accident. The attackers used the
disaster to lure potential victims into opening a malicious A malicious document containing information on India’s
.PDF attachment. The .PDF file exploited a vulnerability ballistic missile defense program was used to lure potential
in Adobe Reader—CVE-2010-2883, in order to drop victims into opening it. This document contains malicious
<MALWARE>TROJ_WIMMIE</MALWARE> onto the target’s system.10 This malware code that exploits a vulnerability in Microsoft Office—CVE-
communicated with a <MALWARE>Luckycat</MALWARE> C&C server. The decoy 2010-3333, to drop <MALWARE>TROJ_WIMMIE</MALWARE> onto a compromised
document contains the radiation dose measurement system so this would connect to a C&C server the <MALWARE>Luckycat</MALWARE>
results, which were published on the Tokyo Power Electric hackers operate.12
Company (TEPCO) website.11
10 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-2883
11 http://www.tepco.co.jp/nu/monitoring/11032805.pdf 12 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3333
PAGE 4 | LUCKYCAT REDUX

VULNERABILITIES AND MALWARE
SAMPLES
Example 3: <GEO>Tibet</GEO>
Most of the samples we have seen exploited CVE-2010-
3333. Dubbed the “Rich Text Format (RTF) Stack Buffer
Overflow Vulnerability,” this causes a buffer overflow in
the Microsoft Word RTF parser when the “pFragments”
shape property is given a malformed value.
To verify the exploitation, one should look out for the
following keywords:
• pFragments: Seen after the string, “\sn”
• \sv: Exploit code is seen after this
The typical structure of the malicious RTF document is:
{\rtf1{\shp{\sp{\sn pFragments}{\sv
Figure 3: Decoy document opened after exploiting a Microsoft “exploit code”}}}}
Office vulnerability
The rest of the samples we found exploited the following
Malicious emails and .DOC attachments that leverage vulnerabilities in Adobe Reader and Flash Player:
Tibetan themes in order to trick recipients into opening
them have been found. This particular sample exploits the • CVE-2010-2883: Adobe Reader TTF SING table
same vulnerability in Microsoft Office—CVE-2010-3333, to parsing vulnerability
drop <MALWARE>TROJ_WIMMIE</MALWARE> onto the target’s system so it would
communicate back to a C&C server the <MALWARE>Luckycat</MALWARE> hackers • CVE-2010-3654: Adobe Flash Player AVM2 multi-name
operate. button class vulnerability13
• CVE-2011-0611: Adobe Flash Player AVM1 shared object
type vulnerability14
• CVE-2011-2462: Adobe Reader U3D component
vulnerability15
13 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3654
14 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-0611
15 http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2011-2462
PAGE 5 | <MALWARE>LUCKYCAT</MALWARE> REDUX

MD5 CVE Identifier Campaign Code
dab3f591b37f5147ae92570323b5c47d CVE-2010-3333 w1229
c023544af85edacc66cd577a0d665dec CVE-2010-3333 w1229
cff0964ed2df5659b0a563f32b7c3eca CVE-2010-3333 214
3deb2a5fcb6bf1f80a074fd351e6f620 CVE-2010-3333 2012
1aa1e795a5ba75f2a5862c6d01205b57 CVE-2010-2883 110824p
CVE-2010-3654
CVE-2011-0611
6a62d4532c7a0656381fee8fb51874d7 CVE-2010-2883 longjiao
CVE-2010-3654
CVE-2011-0611
cb9ab22f3356a3b054a7e9282a69f71e CVE-2011-2462 gop
1dafdc9e507771d0d8887348ce3f1c52 CVE-2010-3333 gop
039a6e012f33495a1308b815ef098459 CVE-2010-3333 luck
be0b2e7a53b1dcacb8c54c180dc4ca27 CVE-2010-2883 11727p
CVE-2010-3654
CVE-2011-0611
00f07b0e701dcfa49e1c907f9242d028 CVE-2010-2883 110705hktq
CVE-2010-3654
CVE-2011-0611
411ab5eb2ef3153b61a49964f9ab4e64 CVE-2011-2462 1229
dcac508495d9800e476aa0c8e11b748d CVE-2010-3333 2012
00e686e382806c33d9ae77256f33ed93 Not applicable LY
Table 1: <MALWARE>Luckycat</MALWARE> malware samples sorted by exploit and campaign code
PAGE 6 | LUCKYCAT REDUX

CAMPAIGN CODES
Each malware attack involves a unique campaign code that • 110714jdap • 64sc109pfye
can be used to track which systems were compromised by
which attack. The campaign codes often contain dates that • 110714tp • 64sc239pf9010
indicate when each malware attack was launched. This
demonstrates how actively and frequently the attackers • 110715x • 720halheli
launched attacks. The campaign codes also reveal the
attackers’ intent, as some of these referenced the intended • 110718p • 729ggggsenior
targets. The following lists the campaign codes we
discovered: • 110816h • 919ggggstp
• 0607e • 1090silver89 • 110824p • ggggstpdomainserver
• 0609af • 110228cl • 1108navyeast • dang279wrdye
• 0613deliinfo • 110311cl • 1108vpsecretary • god
• 0613f • 110315cl • 111031pp • gop
• 0614senior • 110315 • 1110mea • ishan99dfp
• 0616itiT8 • 110321cl • 1114round • j1141ap99
• 0706gggg • 110329 • 1122bol • j4611dq9
• 0804ggggdatanet1 • 110504 • 1122gmail • kondulgml27pfye
• 0805ggggetp • 110603p89 • 1122other • longjiao
• 0805ggggstp • 110606rg789 • 11421is9 • luck
• 0805ecil • 110616np • 1145j9yb • LY
• 0805gggg • 110705hktq • 1147s9 • nec3rd79dfp
• 0818ICG • 110706gggg • 1148dq8 • nfounrsvan99uc
• 0823ggggARDE • 110706hal • 11614lmpn • nne
• 0824ggg • 110705hktq • 11725imp • ongs239pfye
• 0826ggggtnd • 110708hktqw • 11727p • sai
• 1017navydiwali • 110711gggg • 1229 • stmlsp211wd
• 1017ggg • 110711hal • 2012 • w1229
• 1025gggCSC • 110711xzg • 214 • wwwroot
• 1025gggSC • 110713jp • 28 • zz1227
PAGE 7 | LUCKYCAT REDUX

COMMAND AND CONTROL
The <CAMPAIGN>Luckycat</CAMPAIGN> campaign extensively use free hosting The attackers also maintain servers that do not appear to
services. We recorded the domains the attackers used as be from free web-hosting service providers. In fact, these
well as the email addresses they utilized to register the appear to use dedicated VPS services.
domains, if available. While the domains, including their
suffixes, were considerably diverse, all were available
Domain Email Address
from three different free hosting services. As such, the
attackers had nothing to lose but time in order to continue clbest.greenglassint.net 19013788@qq.com
creating diverse domain names for C&C servers. bailianlan.c.dwyu.com dayinok@qq.com
duojee.info duojeewei@qq.com
Domain Email Address
Table 3: C&C servers that the attackers hosted on VPSs
cattree.1x.biz lindagreen56@rediffmail.com
charlesbrain.shop.co yamagami_2011@mail.goo. We also found advertisements for VPS services using two
ne.jp of the C&C server IP addresses in Table 3. While the VPS
footballworldcup.website.org ajayalpna@hotmail.com services were advertised in Chinese forums, the servers
frankwhales.shop.co yamagami_2011@mail.goo. were actually hosted in the <GEO>United States</GEO>.
ne.jp
hi21222325.x.gg hi2122325@hotmail.com
kinkeechow.shop.co kinkee_chow@mail.goo.ne.jp
kittyshop.kilu.org pbdelhioffice@gmail.com
perfect.shop.co dsang72@yahoo.com
pumasports.website.org ranjitrai123@hotmail.com
tomsburs.shop.co yamagami_2011@mail.goo.
ne.jp
vpoasport.shopping2000.com beenznair@gmail.com
goodwell.all.co.uk paltry.parrot@googlemail.com
Figure 4: Sample ads for the VPS services the attackers use
fireequipment.website.org shrivastava.agrim@gmail.com
tennissport.website.org manindramohanshukla@ The diversity of C&C hosting services used provided
yahoo.com the attackers a resilient infrastructure. If one server, for
waterpool.website.org jaganacharya@hotmail.com instance, was shut down for malicious activity, they can
tb123.xoomsite.com
easily create more servers. As victims of interest are
identified, they can also be easily moved from free hosting
tbda123.gwchost.com servers to C&C servers set up on more stable VPSs. The
toms.0fees.net domain and geographic diversity of the IP addresses also
tomygreen.0fees.net helped mask the attackers’ locations.
killmannets.0fees.net
maritimemaster.kilu.org
masterchoice.shop.co
jeepvihecle.shop.co
lucysmith.0fees.net
Table 2: Free web-hosting service domains the attackers used for
C&C servers
PAGE 8 | <MALWARE>LUCKYCAT</MALWARE> REDUX

OPERATIONS
The threat actors behind the <CAMPAIGN>Luckycat</CAMPAIGN> campaign tested
one of their malware samples on a computer under
their control. In the process, they uploaded down.cab,
which contains a command that creates a directory
listing of the available drives on a compromised system,
along with the output of the commands, “ipconfig,”
“tasklist,” and “systeminfo.” We were able to download
this file from the C&C server. While it does not reveal the
attackers’ identities, it does provide an inside view of their
operations.
The result of the “systeminfo” command indicates that the
attackers tested the malware in a virtual environment. The
environment was set up using a Chinese-language version
of Windows XP.
Figure 6: Sample ads for the pirated Windows XP version used
While the rest of the information we gathered did not
reveal significant clues due to the use of a VM, we found
that the attackers left a shared drive—D:\, which was
indexed by the malware. The index was then uploaded to
the C&C server.
Figure 5: Sample system information the attackers obtained after
testing on a virtual machine (VM)
We found that the product ID of the Windows XP software
used was posted online in the past. It was a pirated
Windows XP version that was made available for purchase
in China. Figure 7: Drive left available by the attackers that contains C&C
scripts and victim information
PAGE 9 | <MALWARE>LUCKYCAT</MALWARE> REDUX

In one of the directories—ccclllmmmm, we found that
the attackers put a copy of the count.php C&C backend
as well as a list of the victims and the contents of their
computers. We were also able to find that the C&C server
the attackers used was a victim’s computer.
Figure 9: Anonymity tools the attackers had on the shared D:\
drive
The attackers also had mailing software such as FoxMail
and Supermailer on the shared D:\ drive. While these tools
are not malicious, the attackers used these to easily send
out socially engineered emails. These also allowed them to
keep track of their various identities and email accounts.
One of the samples we obtained used the Chinese-
language version of FoxMail.
Figure 8: Victim information on the attackers’ C&C server that is
identical to the the information on the attackers’ shared D:\ drive The attackers clearly have operational procedures in place
to obscure their true locations with the aid of anonymity
To ensure operational security, the attackers installed Tor tools. They also have a virtualized environment set up to
and Tunnelier. Some of the email samples with malware test and fine-tune their malware as well as the necessary
attachments, in fact, sent through Yahoo! Mail used Tor. tools to maintain their various identities and send out
The use of this anonymity tool allowed the attackers to socially engineered emails with malicious attachments.
obscure their IP addresses, making it increasingly difficult
for researchers to pinpoint their locations.
PAGE 10 | <MALWARE>LUCKYCAT</MALWARE> REDUX

ATTRIBUTION
Additional clues concerning the attackers had to with
the email address, 19013788@qq.com, which was used
to register one of the C&C servers, clbest.greenglassint.
net. This email address can be mapped to the QQ number,
19013788. QQ is popular instant-messaging (IM) software in
<GEO>China</GEO>. This QQ number is linked to a hacker in the Chinese
underground community who goes by the nickname,
“dang0102,” and has published posts in the famous hacker
forum, XFocus, in 2005.
Figure 10: Sample post by dang0102 using the QQ number,
Figure 11: Post by schuhkr using the QQ number, 19013788
19013788
The same hacker also published a post on a student BBS The post in Figure 11 contains two email addresses—
ggggggsccd@sina.com and scuhkr@21cn.com, along
of the <ORG>Sichuan University</ORG> using the nickname, “scuhkr,”
in 2005. He wanted to recruit 2–4 students to a network with an additional QQ number, 2888111. The email address,
attack and defense research project at the Information scuhkr@21cn.com, is also associated with an account on
<ORG>Security Institute</ORG> of the <ORG>Sichuan University</ORG> then. Scuhkr rootkit.com.17 Investigating the second QQ number allowed
also authored articles related to backdoors and shellcode us to determine that scuhkr also used the nickname,
in a hacking magazine that same year.16 “lolibaso.” The other individual mentioned in the post also
worked and studied at the <ORG>Information Security Institute</ORG> of
the <ORG>Sichuan University</ORG> and has published several articles
related to “fuzzing” vulnerabilities in 2006.
16 http://www.cqvip.com/Main/Search.aspx?w=Scuhkr 17 http://dazzlepod.com/rootkit/?page=83
PAGE 11 | <MALWARE>LUCKYCAT</MALWARE> REDUX

CAMPAIGN CONNECTIONS
We were able to identify five malware families that were One of the sample email’s attachments was part of
either used by or hosted on the same dedicated server the <CAMPAIGN>Luckycat</CAMPAIGN> campaign while the other was part of the
with the domain name, duojee.info. Some of these were <CAMPAIGN>ShadowNet</CAMPAIGN> campaign. The <CAMPAIGN>ShadowNet</CAMPAIGN> campaign has
used as second-stage malware that the attackers pushed a history of targeting Tibetan activists as well as the
to victims whose systems have been compromised by first- <ORG>Indian government</ORG>, which fits the profile of the <MALWARE>Luckycat</MALWARE>
stage malware. Second-stage malware typically provided campaigns as well.
additional functionality and were especially used if the
first-stage malware is very simplistic. We also found that
the attackers used several malware families that have
been utilized in previous campaigns. This may indicate a
level of collaboration across campaigns.
<CAMPAIGN>ShadowNet</CAMPAIGN>
The first interesting connection we noticed in conjunction
with the <CAMPAIGN>Luckycat</CAMPAIGN> campaign had to do with <CAMPAIGN>ShadowNet</CAMPAIGN>,
a cyber-espionage network documented by researchers
at the <ORG>University of Toronto</ORG> and the <ORG>ShadowServer
Foundation</ORG>.18 We found a socially engineered email that
had two malicious file attachments.
Figure 13: Relationship between the <CAMPAIGN>Luckycat</CAMPAIGN> and the <CAMPAIGN>ShadowNet</CAMPAIGN>
campaigns
The <MALWARE>ShadowNet</MALWARE> malware, detected by Trend Micro as
<MALWARE>TROJ_GUPD.AB</MALWARE>, first connects to a blog in order to receive
the URL of the C&C server. The URL was encoded using
a modulus operation. The malware on the compromised
computer decodes the URL then issues a connection to
the C&C server. The compromised computer posts data to
a PHP script running on the server, usually named index.
php or all.php, and contains information about it as well as
a campaign code.
The information is stored in a .TXT file on the C&C server.
The compromised computer continues to beacon to the
C&C server to see if the operators have designed any
commands. If they have, the compromised computer then
executes the given commands and reports the results back
to the C&C server.
Figure 12: Sample targeted email with both <MALWARE>Luckycat</MALWARE> and
<MALWARE>ShadowNet</MALWARE> malware attachments
18 http://www.nartv.org/mirror/shadows-in-the-cloud.pdf
PAGE 12 | LUCKYCAT REDUX

Figure 15: Example of a blog used by <MALWARE>ShadowNet</MALWARE> to communicate
an encoded C&C server location
Figure 14: Sample <MALWARE>ShadowNet</MALWARE> malware related to a <MALWARE>Luckycat</MALWARE> The blogs and groups the <MALWARE>ShadowNet</MALWARE> attackers use can
email attack be easily updated whenever the C&C servers are changed.
The URL of the blog is embedded in the malware. The
This attack used the theme of self-immolation in <GEO>Tibet</GEO> for malware connects to the blog and decodes the C&C URL
both the email and the decoy document that is opened then connects to the C&C server. The commands the
after the vulnerability exploitation. The malicious file server issues are also encoded using a simple logical
attachment exploits a vulnerability in Microsoft Office— operator. The malware also decodes these using keycodes
CVE-2010-3333, to drop malware onto the target’s system. that are sent along with the actual commands.
The malware was configured to connect to two blogs and a
Yahoo! Group in order to find the C&C server’s location.
MD5 CVE Identifier Campaign Code
26891c3e4a2de034e4841db2a579734f CVE-2011-2462 circle
ebea24fe1611a1ab778f5ecceb781fad CVE-2010-3333 circle
Table 4: <MALWARE>ShadowNet</MALWARE> malware samples related to the <CAMPAIGN>Luckycat</CAMPAIGN> campaign
<CAMPAIGN>Duojeen</CAMPAIGN>
The malware attacks related to the <CAMPAIGN>Duojeen</CAMPAIGN> campaign all target the Tibetan community and use a single C&C server—
duojee.info. We also found that a malware binary available for download from duojee.info is a <MALWARE>TROJ_WIMMIE</MALWARE> Trojan that
connects back to bailianlan.c.dwyu.com—a C&C server the <MALWARE>Luckycat</MALWARE> attackers use.
PAGE 13 | <MALWARE>LUCKYCAT</MALWARE> REDUX

Figure 16: Relationship between the <CAMPAIGN>Duojeen</CAMPAIGN> and the <CAMPAIGN>Luckycat</CAMPAIGN> campaigns
The duojee.info server is the C&C component of the The <MALWARE>Duojeen</MALWARE> malware continues to poll the C&C server
<CAMPAIGN>Duojeen</CAMPAIGN> campaign. The related malware, detected by then executes one of the only possible commands
<ORG>Trend Micro</ORG> as BKDR_DUOJEEN.A, connects to a C&C specified by the attackers:
server and posts data to a PHP script typically named,
linux.php, solaris.php, or freebsd.php. The following • Stop the malware from communicating with the C&C
information is encoded using logical operators such as xor, server
or, or bitwise shifting on adjacent bytes in the malware:
• Download and execute a second-stage malware
• Hostname
• Computer name
• MAC address
• IP address, subnet mask, and gateway
• Network resources
• Running processes
• Microsoft Outlook user account information (e.g., HTTP
Figure 17: Sample <MALWARE>Duojeen</MALWARE> attack email
mail user name, POP3 user name, or POP3 server)
• Recently opened files
PAGE 14 | <MALWARE>LUCKYCAT</MALWARE> REDUX

One of the <THREAT_ACTOR>Duojeen</THREAT_ACTOR> attacks leverages a Tibetan-themed job ad to encourage potential victims to open an attached
document that exploits a vulnerability in Microsoft Office—CVE-2010-3333, in order to drop a malware that connects to
duojee.info.
MD5 CVE Identifier Campaign Code
715cbbe21844bbb4f1f60a91ae28def3 CVE-2010-3333 aaaa
a9bda3c31fc6acc83a5226226f7ab554 CVE-2010-3333 aaaa
567a774cf865b50189e81c14b4ca4b63 CVE-2010-3333 aaaa
e62c115b6874726c309b3038a9391e28 CVE-2010-3333 aaaa
9860d087892fce98e6f639e3e9dba91e Not applicable aaa
d773e3bacc2c8389c2ab51c9cbc68480 Not applicable aaa
Table 5: <MALWARE>Duojeen</MALWARE> malware samples
<MALWARE>Duojee.info</MALWARE> also contains the PHP scripts used for
commanding and controlling the <CAMPAIGN>Luckycat</CAMPAIGN> campaign at
/holly/count.php as well as <CAMPAIGN>ShadowNet</CAMPAIGN> at /soom/cont.php.
The duojee.info server also has a phishing page designed
to steal passwords from mail.tibet.net users.
Figure 18: Phishing page hosted on duojee.info
The duojee.info server also has other malware from
two additional families available for download. One Figure 19: Relationship between the <MALWARE>Sparksrv</MALWARE> and the <MALWARE>Luckycat</MALWARE>
malware is known as “<MALWARE>Comfoo</MALWARE>,” related to yet another campaigns
cyber-espionage campaign, while the other is known as
“<CAMPAIGN>Sparksrv</CAMPAIGN>.” The <MALWARE>Sparksrv</MALWARE> malware, detected by Trend Micro as <MALWARE>BKDR_
RPKNUF.A</MALWARE>, was initially found on a <MALWARE>ShadowNet</MALWARE> server in
November 2011. We have, however, found several instances
<MALWARE>Sparksrv</MALWARE> of a newer version of the same malware on <MALWARE>duojee</MALWARE>.
info. The malware initially sends the following plain-text
Sparksrv refers to a second-stage malware that provides information through port 443:
backdoor access with significantly more functionality • IP address
than first-stage droppers. Second-stage malware, often • Identifier
Remote Administration Trojans (RATs), are deployed
because first-stage malware only provide simple “check-in” • MAC address
functionality such as a short list of commands that can be
scheduled. Second-stage RATs, on the other hand, provide
an additional access channel as well as “real-time” control
over a compromised machine if the attackers and the
victims are online at the same time.
PAGE 15 | <MALWARE>LUCKYCAT</MALWARE> REDUX

Once the malware establishes a connection, it then starts to receive commands from the C&C server, which allow the
attackers to do the following:
• Start or kill a process • Create or delete
directories
• Copy or search for a file
• Load a DLL
• Download or upload
files • Invoke a command shell
MD5 Domain IP Address
0a927897ab5acff1e6bd45897368253b fidk.rkntils.dnset.com 69.162.71.254
b53f71e4dd2ca8826e6191dee439564b fidk.rkntils.dnset.com 69.162.71.254
a2b37776e0bd6594c688a8214371b9ff rukiyeangel.dyndns.pro 199.192.152.100
Table 6: <MALWARE>Sparksrv</MALWARE> malware samples and C&C locations
We also found an older version of the malware on a
<MALWARE>ShadowNet</MALWARE> server, sunshine.shop.co.
MD5 IP Address
d0eec59f1e74c0851c8dd1c8be88f2b9 173.208.242.25
Table 7: Older <MALWARE>Sparksrv</MALWARE> malware version found on a <MALWARE>ShadowNet</MALWARE>
server
<MALWARE>Comfoo</MALWARE>
<MALWARE>Comfoo</MALWARE> malware have been seen in conjunction with
campaigns targeting sensitive entities in both Japan and
India. We found a version of the <MALWARE>Comfoo</MALWARE> malware on the
duojee.info server as well as an email attack that used the
same version of <MALWARE>Comfoo</MALWARE> malware. In fact, the .DOC file
used in the attack dropped an .EXE file with the same MD5
hash as the one found on the duojee.info server.
Figure 20: Relationship between the <MALWARE>Comfoo</MALWARE> and the <MALWARE>Luckycat</MALWARE>
campaigns
PAGE 16 | <MALWARE>LUCKYCAT</MALWARE> REDUX

While at least two of the <MALWARE>Comfoo</MALWARE> variants are essentially
the same, the traffic encryption methods used in the
<MALWARE>Comfoo</MALWARE> sample found in connection with <MALWARE>duojee.info</MALWARE>
differed from other <MALWARE>Comfoo</MALWARE> variants we’ve analyzed that
are not directly related to the <MALWARE>Luckycat</MALWARE> campaign. The
more common <MALWARE>Comfoo</MALWARE> malware samples we analyzed used
custom encryption methods while the variant found on
the <MALWARE>duojee.info</MALWARE> server utilized the Windows Cryptographic
Application Programming Interface (API). This <MALWARE>Comfoo</MALWARE>
variant’s initial network communication sent the following
information to the C&C server:
• Randomly generated characters
• MAC address Figure 21: Sample <MALWARE>Comfoo</MALWARE> campaign email
• IP address This <MALWARE>Comfoo</MALWARE> email attack leverages the current situation
in Tibet to encourage recipients to open a malicious
• OS version attachment that exploits a vulnerability in Microsoft
Office—CVE-2010-3333, in order to drop a malware onto the
• String, “liberate,” as campaign code target’s system.
The attackers gather the following information from
infected systems:
• CPU, NETBIOS, and disk information
• System, OS version, and account information
• Network adapters, protocols, and configuration
information
• Installed applications as well as Internet Explorer (IE)
and Browser Helper Object (BHO) information
The malware the attackers use is capable of receiving
several commands.
Command Description
Figure 22: <MALWARE>Comfoo</MALWARE> decoy document that exploits a Microsoft
0x233C Invoke command shell Office vulnerability
0x1B6C Take screenshot
After the decoy document opens, the <MALWARE>Comfoo</MALWARE> malware
0x139C Start interactive desktop
begins to communicate with johnnees.rkntils.10dig.net,
0x1F54 Start keylogging which resolves to the IP address, 69.162.71.254—the same
0xFDC Stop service host that some <MALWARE>Sparksrv</MALWARE> malware samples we analyzed
0xFF0 Delete service use.
0xBCC Enumerate running processes
0xBE0 Terminate process
0x2EF4 Download file
Table 8: Commands the <MALWARE>Comfoo</MALWARE> malware receive
PAGE 17 | <MALWARE>LUCKYCAT</MALWARE> REDUX

MD5 CVE Identifier Campaign Code
24552d599b650ca3ecd467d9d740de33 CVE-2010-3333 liberate
6815ab1f11ac33d4c1149efc3206d794 Not applicable liberate
6bd4e7d7408e0d8d1592e27fc19650c8 Not applicable liberate
Table 9: <MALWARE>Comfoo</MALWARE> malware samples
The samples in Table 9 connect to havefuns.rkntils.10dig.net or johnnees.rkntils.10dig.net, which both resolve to the same
IP address—69.162.71.254.
PAGE 18 | <MALWARE>LUCKYCAT</MALWARE> REDUX

CONCLUSION DEFENDING AGAINST APTS
Targeted attacks have been extremely successful, Sufficiently motivated threat actors can penetrate
making the scope of the problem truly global. These even networks that use moderately advanced security
have been affecting governments, militaries, defense measures. As such, apart from standard and relevant
industries, high-technology companies, intergovernmental attack prevention measures and mechanisms such as
organizations, nongovernmental organizations (NGOs), solid patch management; endpoint and network security;
media organizations, academic institutions, and activists firewall use; and the like, enterprises should also focus
worldwide. on detecting and mitigating attacks. Moreover, data loss
prevention (DLP) strategies such as identifying exactly
Targeted attacks are not isolated smash-and-grab what an organization is protecting and taking into account
incidents. They are part of consistent campaigns that the context of data use should be employed.
aim to establish persistent, covert presence in a target’s
network so that information can be extracted as needed. Local and External Threat Intelligence
Targeted attacks may not be easy to understand but
careful monitoring allows researchers to leverage the Threat intelligence refers to indicators that can be used
mistakes attackers make to get a glimpse inside their to identify the tools, tactics, and procedures threat actors
operations. Moreover, we can track cyber-espionage engaging in targeted attacks utilize. Both external and
campaigns over time using a combination of technical and local threat intelligence is crucial for developing the
contextual indicators. ability to detect attacks early. The following are the core
components of this defense strategy:
This paper specifically discussed the <CAMPAIGN>Luckycat</CAMPAIGN> campaign.
In the course of our research, we discovered that it had a • Enhanced visibility: Logs from endpoint, server,
much more diverse target set than previously thought. Not and network monitoring are an important and often
only did the attackers target military research institutions underused resource that can be aggregated to provide
in India, as earlier disclosed by <ORG>Symantec</ORG>, they also a view of the activities within an organization that
targeted sensitive entities in Japan and India as well as can be processed for anomalous behaviors that can
Tibetan activists. They used a diversity of infrastructure indicate a targeted attack.
as well, ranging from throw-away free-hosting sites to
dedicated VPSs. • Integrity checks: In order to maintain persistence,
malware will make modifications to the file system and
We also found that the <CAMPAIGN>Luckycat</CAMPAIGN> campaign can be linked registry. Monitoring such changes can indicate the
to other campaigns as well. The people behind it used or presence of malware.
provided infrastructure for other campaigns that have also
been linked to past targeted attacks such as the previously • Empowering the human analyst: Humans are best
documented <CAMPAIGN>ShadowNet</CAMPAIGN> campaign.19 positioned to identify anomalous behaviors when
presented with a view of aggregated logs from across
Understanding the attack tools, techniques, and a network. This information is used in conjunction with
infrastructure used in the <CAMPAIGN>Luckycat</CAMPAIGN> campaign as well as custom alerts based on the local and external threat
how an individual incident is related to a broader campaign intelligence available.
provides the context necessary for us to assess its impact
and come up with defensive strategies in order to protect
our customers.
19 http://www.nytimes.com/2010/04/06/science/06cyber.html?_r=2
PAGE 19 | <MALWARE>LUCKYCAT</MALWARE> REDUX

Technologies available today such as Deep Discovery Educating Employees Against Social
provide visibility, insight, and control over networks to
defend against targeted threats.20 Deep Discovery uniquely Engineering
detects and identifies evasive threats in real time and
provides in-depth analysis and actionable intelligence to Security-related policies and procedures combined with
prevent, discover, and reduce risks. education and training programs are essential components
of defense. Traditional training methods can be fortified
Mitigation and Cleanup Strategy by simulations and exercises using real spear-phishing
attempts sent to test employees. Employees trained to
expect targeted attacks are better positioned to report
Once an attack is identified, the cleanup strategy should potential threats and constitute an important source of
focus on the following objectives: threat intelligence.
• Determine the attack vector and cut off
communications with the C&C server. Data-Centric Protection Strategy
• Determine the scope of the compromise. The ultimate objective of targeted attacks is to acquire
sensitive data. As such, DLP strategies that focus on
• Assess the damage by analyzing the data and forensic identifying and protecting confidential information are
artifacts available on compromised machines. critical. Enhanced data protection and visibility across
an enterprise provides the ability to control access to
Remediation should be applied soon afterward, which sensitive data as well as monitor and log successful and
includes steps to fortify affected servers, machines, or unsuccessful attempts to access it. Enhanced access
devices into secure states, informed in part by how the control and logging capabilities allow security analysts to
compromised machines were infiltrated. locate and investigate anomalies, respond to incidents, and
initiate remediation strategies and damage assessment.
20 http://www.trendmicro.com/us/enterprise/security-risk-management/
deep-discovery/index.html
PAGE 20 | <MALWARE>LUCKYCAT</MALWARE> REDUX

TREND MICRO THREAT
PROTECTION AGAINST <MALWARE>LUCKYCAT</MALWARE>
CAMPAIGN COMPONENTS
The following table summarizes the <ORG>Trend Micro</ORG> solutions for the components of the <CAMPAIGN>Luckycat</CAMPAIGN> campaign. <ORG>Trend Micro</ORG>
recommends a comprehensive security risk management strategy that goes further than advanced protection to meet
the real-time threat management requirements of dealing with targeted attacks.
Attack Component Protection Technology <ORG>Trend Micro</ORG> Solution
HTTP C&C communication fingerprint Web Reputation Endpoint (Titanium, Worry-Free Business
count.php?m=c&n=[HOSTNAME]_[MAC_ Security, OfficeScan)
ADDRESS]_[CAMPAIGN_CODE]@ Server (Deep Security)
Messaging (InterScan Messaging Security,
ScanMail Suite for Microsoft Exchange)
Network (Deep Discovery)
Gateway (InterScan Web Security,
InterScan Messaging Security)
Mobile (Mobile Security)
TROJ_WIMMIE File Reputation Endpoint (Titanium, Worry-Free Business
VBS_WIMMIE (Antivirus/Anti-malware) Security, OfficeScan)
Server (Deep Security)
Messaging (InterScan Messaging Security,
ScanMail Suite for Microsoft Exchange)
Network (Deep Discovery)
Gateway (InterScan Web Security,
InterScan Messaging Security)
Mobile (Mobile Security)
PAGE 21 | <MALWARE>LUCKYCAT</MALWARE> REDUX

Attack Component Protection Technology <ORG>Trend Micro</ORG> Solution
CVE-2010-3333 Vulnerability Shielding/Virtual Patching Server (Deep Security)
CVE-2010-2883 Endpoint (OfficeScan with Intrusion
CVE-2010-3654 Defense Firewall Plug-In)
CVE-2011-0611 For CVE-2010-3333:
CVE-2011-2462 Rule #1004498 (Microsoft Word
.RTF File Parsing Stack Buffer
Overflow Vulnerability)
For CVE-2010-2883:
Rule #1004393 (Adobe Reader SING
Table Parsing Vulnerability)
Rule #1004113 (identified malicious
.PDF file)
Rule #1004315 (identified malicious
.PDF file - 3)
For CVE-2010-3654:
Rule #1004497 (Adobe Flash
Player Unspecified Code Execution
Vulnerability)
For CVE-2011-0611:
Rule #1004801 (Adobe Flash
Player .SWF File Remote Memory
Corruption Vulnerability)
Rule #1004114 (identified malicious
.SWF file)
Rule #1004647 (restrict Microsoft
Office file with embedded .SWF file)
For CVE-2011-2462:
Rule #1004871 (Adobe Acrobat/
Reader U3D Component Memory
Corruption Vulnerability)
Rule #1004873 (Adobe Acrobat/
Reader U3D Component Memory
Corruption)
PAGE 22 | <MALWARE>LUCKYCAT</MALWARE> REDUX

Attack Component Protection Technology <ORG>Trend Micro</ORG> Solution
cattree.1x.biz Web, Domain, and IP Reputation Endpoint (Titanium, Worry-Free Business
charlesbrain.shop.co Security, OfficeScan)
footballworldcup.website.org Server (Deep Security)
frankwhales.shop.co Messaging (InterScan Messaging Security,
hi21222325.x.gg ScanMail Suite for Microsoft Exchange)
kinkeechow.shop.co Network (Deep Discovery)
kittyshop.kilu.org Gateway (InterScan Web Security,
perfect.shop.co InterScan Messaging Security)
pumasports.website.org Mobile (Mobile Security)
tomsburs.shop.co
vpoasport.shopping2000.com
goodwell.all.co.uk
fireequipment.website.org
tennissport.website.org
waterpool.website.org
tb123.xoomsite.com
tbda123.gwchost.com
toms.0fees.net
tomygreen.0fees.net
killmannets.0fees.net
maritimemaster.kilu.org
masterchoice.shop.co
jeepvihecle.shop.co
lucysmith.0fees.net
<ORG>TREND MICRO™</ORG> <ORG>TREND MICRO INC.</ORG>
<ORG>Trend Micro</ORG> Incorporated (TYO: 4704; TSE: 4704), a global cloud security 10101 N. De Anza Blvd.
leader, creates a world safe for exchanging digital information with its In- Cupertino, CA 95014
ternet content security and threat management solutions for businesses
and consumers. A pioneer in server security with over U.S. toll free: 1 +800.228.5651
20 years’ experience, we deliver top-ranked client, server and cloud- Phone: 1 +408.257.1500
based security that fits our customers’ and partners’ needs, stops Fax: 1 +408.257.2003
new threats faster, and protects data in physical, virtualized and cloud www.trendmicro.com
environments. Powered by the industry-leading <ORG>Trend Micro™ Smart Pro-
tection Network™</ORG> cloud computing security infrastructure, our products
and services stop threats where they emerge—from the Internet. They are
supported by 1,000+ threat intelligence experts around the globe.
©2012 by <ORG>Trend Micro,</ORG> Incorporated. All rights reserved. <ORG>Trend Micro</ORG> and the <ORG>Trend Micro</ORG> t-ball logo are trademarks or registered trademarks of <ORG>Trend Micro</ORG>, Incorporated. All other product or company
names may be trademarks or registered trademarks of their owners.
PAGE 23 | <MALWARE>LUCKYCAT</MALWARE> REDUX

March 2012 | APT Campaign Quick Profile: <CAMPAIGN>LUCKYCAT</CAMPAIGN>
Advanced persistent threats (APTs) refer to a category of threats that aggressively pursue and compromise specific
targets to maintain persistent presence within the victim’s network so they can move laterally and exfiltrate data. Unlike
indiscriminate cybercrime attacks, spam, web threats, and the like, APTs are much harder to detect because of the
targeted nature of related components and techniques. Also, while cybercrime focuses on stealing credit card and banking
information to gain profit, APTs are better thought of as cyber espionage.
<CAMPAIGN>LUCKYCAT</CAMPAIGN>
First Seen
Individual targeted attacks are not one-off attempts. Attackers continually try to get inside the target’s network.
The <CAMPAIGN>Luckycat</CAMPAIGN> campaign has been active since at least June 2011.
Victims and Targets
APT campaigns target specific industries or communities of interest in specific regions.
The <CAMPAIGN>Luckycat</CAMPAIGN> campaign has been linked to 90 attacks against the following industries and/or communities in Japan and India:
AEROSPACE ENERGY ENGINEERING SHIPPING MILITARY RESEARCH TIBETAN ACTIVISTS
The threat actors behind the <CAMPAIGN>Luckycat</CAMPAIGN> campaign used a unique campaign code to track victims of specific attacks.
Operations
The 1st-stage computer intrusions often use social engineering. Attackers custom-fit attacks to their targets.
»» Targeted emails that are contextually relevant (i.e., emails containing a decoy document of radiation dose measurement results
sent some time after the Great East Japan Earthquake)
»» Exploited CVE-2010-3333 (aka, Rich Text Format [RTF] Stack Buffer Overflow Vulnerability) in several instances, although Adobe
Reader and Flash Player vulnerabilities were also exploited
»» Used <MALWARE>TROJ_WIMMIE</MALWARE> or <MALWARE>VBS_WIMMIE</MALWARE>—malware that take advantage of the Windows Management Instrumentation (WMI), making
the backdoor component undetectable through file scanning
»» The <MALWARE>WIMMIE</MALWARE> malware, once inside the network, connects to a command-and-control (C&C) server via HTTP over port 80
»» Attackers heavily used free web-hosting services to host their C&C servers under a diverse set of domain names but also used
virtual private servers (VPSs) for more stable operations
Possible Indicators of Compromise
Attackers want to remain undetected as long as possible. A key characteristic of these attacks is stealth.
<MALWARE>WIMMIE</MALWARE> malware do not leave much network fingerprint. However, the following is an identifiable HTTP C&C communication
fingerprint—count.php?m=c&n=[HOSTNAME]_[MAC_ADDRESS]_[CAMPAIGN_CODE]@. This format can also be seen in the URL
inside the script when /namespace:\\root\subscription path __eventconsumer is typed in the command line for WMI.
Relationship with Other APT Campaigns
Malware identified with the <CAMPAIGN>ShadowNet</CAMPAIGN>, <CAMPAIGN>Duojeen</CAMPAIGN>, <CAMPAIGN>Sparksrv</CAMPAIGN>, and <CAMPAIGN>Comfoo</CAMPAIGN> campaigns were used or found hosted on the same dedicated server used
by the <CAMPAIGN>Luckycat</CAMPAIGN> campaign.